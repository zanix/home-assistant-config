function e(e,t,o,i){var a,r=arguments.length,n=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(n=(r<3?a(n):r>3?a(t,o,n):a(t,o))||n);return r>3&&n&&Object.defineProperty(t,o,n),n}var t,o;function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}!function(e){e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none"}(t||(t={})),function(e){e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24"}(o||(o={}));var a=function(e,o,i){var a=o?function(e){switch(e.number_format){case t.comma_decimal:return["en-US","en"];case t.decimal_comma:return["de","es","it"];case t.space_comma:return["fr","sv","cs"];case t.system:return;default:return e.language}}(o):void 0;if(Number.isNaN=Number.isNaN||function e(t){return"number"==typeof t&&e(t)},(null==o?void 0:o.number_format)!==t.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(a,r(e,i)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,r(e,i)).format(Number(e))}return"string"==typeof e?e:function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)}(e,null==i?void 0:i.maximumFractionDigits).toString()+("currency"===(null==i?void 0:i.style)?" "+i.currency:"")},r=function(e,t){var o=i({maximumFractionDigits:2},t);if("string"!=typeof e)return o;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var a=e.indexOf(".")>-1?e.split(".")[1].length:0;o.minimumFractionDigits=a,o.maximumFractionDigits=a}return o};const n=window,l=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),d=new WeakMap;class c{constructor(e,t,o){if(this._$cssResult$=!0,o!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(l&&void 0===e){const o=void 0!==t&&1===t.length;o&&(e=d.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&d.set(t,e))}return e}toString(){return this.cssText}}const u=(e,...t)=>{const o=1===e.length?e[0]:t.reduce(((t,o,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[i+1]),e[0]);return new c(o,e,s)},v=l?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const o of e.cssRules)t+=o.cssText;return(e=>new c("string"==typeof e?e:e+"",void 0,s))(t)})(e):e;var _;const h=window,p=h.trustedTypes,y=p?p.emptyScript:"",m=h.reactiveElementPolyfillSupport,f={toAttribute(e,t){switch(t){case Boolean:e=e?y:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let o=e;switch(t){case Boolean:o=null!==e;break;case Number:o=null===e?null:Number(e);break;case Object:case Array:try{o=JSON.parse(e)}catch(e){o=null}}return o}},g=(e,t)=>t!==e&&(t==t||e==e),b={attribute:!0,type:String,converter:f,reflect:!1,hasChanged:g};class w extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,o)=>{const i=this._$Ep(o,t);void 0!==i&&(this._$Ev.set(i,o),e.push(i))})),e}static createProperty(e,t=b){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const o="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,o,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||b}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const o of t)this.createProperty(o,e[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const o=new Set(e.flat(1/0).reverse());for(const e of o)t.unshift(v(e))}else void 0!==e&&t.push(v(e));return t}static _$Ep(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,o;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(o=e.hostConnected)||void 0===o||o.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{l?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const o=document.createElement("style"),i=n.litNonce;void 0!==i&&o.setAttribute("nonce",i),o.textContent=t.cssText,e.appendChild(o)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t,o=b){var i;const a=this.constructor._$Ep(e,o);if(void 0!==a&&!0===o.reflect){const r=(void 0!==(null===(i=o.converter)||void 0===i?void 0:i.toAttribute)?o.converter:f).toAttribute(t,o.type);this._$El=e,null==r?this.removeAttribute(a):this.setAttribute(a,r),this._$El=null}}_$AK(e,t){var o;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(o=e.converter)||void 0===o?void 0:o.fromAttribute)?e.converter:f;this._$El=a,this[a]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,o){let i=!0;void 0!==e&&(((o=o||this.constructor.getPropertyOptions(e)).hasChanged||g)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===o.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,o))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const o=this._$AL;try{t=this.shouldUpdate(o),t?(this.willUpdate(o),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(o)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(o)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var x;w.finalized=!0,w.elementProperties=new Map,w.elementStyles=[],w.shadowRootOptions={mode:"open"},null==m||m({ReactiveElement:w}),(null!==(_=h.reactiveElementVersions)&&void 0!==_?_:h.reactiveElementVersions=[]).push("1.6.1");const $=window,k=$.trustedTypes,E=k?k.createPolicy("lit-html",{createHTML:e=>e}):void 0,C="$lit$",z=`lit$${(Math.random()+"").slice(9)}$`,S="?"+z,M=`<${S}>`,A=document,P=()=>A.createComment(""),D=e=>null===e||"object"!=typeof e&&"function"!=typeof e,T=Array.isArray,O="[ \t\n\f\r]",j=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N=/-->/g,G=/>/g,B=RegExp(`>|${O}(?:([^\\s"'>=/]+)(${O}*=${O}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),F=/'/g,R=/"/g,H=/^(?:script|style|textarea|title)$/i,L=e=>(t,...o)=>({_$litType$:e,strings:t,values:o}),I=L(1),U=L(2),W=Symbol.for("lit-noChange"),V=Symbol.for("lit-nothing"),Z=new WeakMap,K=A.createTreeWalker(A,129,null,!1);class Y{constructor({strings:e,_$litType$:t},o){let i;this.parts=[];let a=0,r=0;const n=e.length-1,l=this.parts,[s,d]=((e,t)=>{const o=e.length-1,i=[];let a,r=2===t?"<svg>":"",n=j;for(let t=0;t<o;t++){const o=e[t];let l,s,d=-1,c=0;for(;c<o.length&&(n.lastIndex=c,s=n.exec(o),null!==s);)c=n.lastIndex,n===j?"!--"===s[1]?n=N:void 0!==s[1]?n=G:void 0!==s[2]?(H.test(s[2])&&(a=RegExp("</"+s[2],"g")),n=B):void 0!==s[3]&&(n=B):n===B?">"===s[0]?(n=null!=a?a:j,d=-1):void 0===s[1]?d=-2:(d=n.lastIndex-s[2].length,l=s[1],n=void 0===s[3]?B:'"'===s[3]?R:F):n===R||n===F?n=B:n===N||n===G?n=j:(n=B,a=void 0);const u=n===B&&e[t+1].startsWith("/>")?" ":"";r+=n===j?o+M:d>=0?(i.push(l),o.slice(0,d)+C+o.slice(d)+z+u):o+z+(-2===d?(i.push(void 0),t):u)}const l=r+(e[o]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==E?E.createHTML(l):l,i]})(e,t);if(this.el=Y.createElement(s,o),K.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=K.nextNode())&&l.length<n;){if(1===i.nodeType){if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith(C)||t.startsWith(z)){const o=d[r++];if(e.push(t),void 0!==o){const e=i.getAttribute(o.toLowerCase()+C).split(z),t=/([.?@])?(.*)/.exec(o);l.push({type:1,index:a,name:t[2],strings:e,ctor:"."===t[1]?ee:"?"===t[1]?oe:"@"===t[1]?ie:X})}else l.push({type:6,index:a})}for(const t of e)i.removeAttribute(t)}if(H.test(i.tagName)){const e=i.textContent.split(z),t=e.length-1;if(t>0){i.textContent=k?k.emptyScript:"";for(let o=0;o<t;o++)i.append(e[o],P()),K.nextNode(),l.push({type:2,index:++a});i.append(e[t],P())}}}else if(8===i.nodeType)if(i.data===S)l.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(z,e+1));)l.push({type:7,index:a}),e+=z.length-1}a++}}static createElement(e,t){const o=A.createElement("template");return o.innerHTML=e,o}}function q(e,t,o=e,i){var a,r,n,l;if(t===W)return t;let s=void 0!==i?null===(a=o._$Co)||void 0===a?void 0:a[i]:o._$Cl;const d=D(t)?void 0:t._$litDirective$;return(null==s?void 0:s.constructor)!==d&&(null===(r=null==s?void 0:s._$AO)||void 0===r||r.call(s,!1),void 0===d?s=void 0:(s=new d(e),s._$AT(e,o,i)),void 0!==i?(null!==(n=(l=o)._$Co)&&void 0!==n?n:l._$Co=[])[i]=s:o._$Cl=s),void 0!==s&&(t=q(e,s._$AS(e,t.values),s,i)),t}class J{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var t;const{el:{content:o},parts:i}=this._$AD,a=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:A).importNode(o,!0);K.currentNode=a;let r=K.nextNode(),n=0,l=0,s=i[0];for(;void 0!==s;){if(n===s.index){let t;2===s.type?t=new Q(r,r.nextSibling,this,e):1===s.type?t=new s.ctor(r,s.name,s.strings,this,e):6===s.type&&(t=new ae(r,this,e)),this._$AV.push(t),s=i[++l]}n!==(null==s?void 0:s.index)&&(r=K.nextNode(),n++)}return a}v(e){let t=0;for(const o of this._$AV)void 0!==o&&(void 0!==o.strings?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}}class Q{constructor(e,t,o,i){var a;this.type=2,this._$AH=V,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=i,this._$Cp=null===(a=null==i?void 0:i.isConnected)||void 0===a||a}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===(null==e?void 0:e.nodeType)&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=q(this,e,t),D(e)?e===V||null==e||""===e?(this._$AH!==V&&this._$AR(),this._$AH=V):e!==this._$AH&&e!==W&&this._(e):void 0!==e._$litType$?this.g(e):void 0!==e.nodeType?this.$(e):(e=>T(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==V&&D(this._$AH)?this._$AA.nextSibling.data=e:this.$(A.createTextNode(e)),this._$AH=e}g(e){var t;const{values:o,_$litType$:i}=e,a="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=Y.createElement(i.h,this.options)),i);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===a)this._$AH.v(o);else{const e=new J(a,this),t=e.u(this.options);e.v(o),this.$(t),this._$AH=e}}_$AC(e){let t=Z.get(e.strings);return void 0===t&&Z.set(e.strings,t=new Y(e)),t}T(e){T(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let o,i=0;for(const a of e)i===t.length?t.push(o=new Q(this.k(P()),this.k(P()),this,this.options)):o=t[i],o._$AI(a),i++;i<t.length&&(this._$AR(o&&o._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cp=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class X{constructor(e,t,o,i,a){this.type=1,this._$AH=V,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=V}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,o,i){const a=this.strings;let r=!1;if(void 0===a)e=q(this,e,t,0),r=!D(e)||e!==this._$AH&&e!==W,r&&(this._$AH=e);else{const i=e;let n,l;for(e=a[0],n=0;n<a.length-1;n++)l=q(this,i[o+n],t,n),l===W&&(l=this._$AH[n]),r||(r=!D(l)||l!==this._$AH[n]),l===V?e=V:e!==V&&(e+=(null!=l?l:"")+a[n+1]),this._$AH[n]=l}r&&!i&&this.j(e)}j(e){e===V?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class ee extends X{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===V?void 0:e}}const te=k?k.emptyScript:"";class oe extends X{constructor(){super(...arguments),this.type=4}j(e){e&&e!==V?this.element.setAttribute(this.name,te):this.element.removeAttribute(this.name)}}class ie extends X{constructor(e,t,o,i,a){super(e,t,o,i,a),this.type=5}_$AI(e,t=this){var o;if((e=null!==(o=q(this,e,t,0))&&void 0!==o?o:V)===W)return;const i=this._$AH,a=e===V&&i!==V||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==V&&(i===V||a);a&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==o?o:this.element,e):this._$AH.handleEvent(e)}}class ae{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){q(this,e)}}const re=$.litHtmlPolyfillSupport;var ne,le;null==re||re(Y,Q),(null!==(x=$.litHtmlVersions)&&void 0!==x?x:$.litHtmlVersions=[]).push("2.7.2");class se extends w{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const o=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=o.firstChild),o}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,o)=>{var i,a;const r=null!==(i=null==o?void 0:o.renderBefore)&&void 0!==i?i:t;let n=r._$litPart$;if(void 0===n){const e=null!==(a=null==o?void 0:o.renderBefore)&&void 0!==a?a:null;r._$litPart$=n=new Q(t.insertBefore(P(),e),e,void 0,null!=o?o:{})}return n._$AI(e),n})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return W}}se.finalized=!0,se._$litElement$=!0,null===(ne=globalThis.litElementHydrateSupport)||void 0===ne||ne.call(globalThis,{LitElement:se});const de=globalThis.litElementPolyfillSupport;null==de||de({LitElement:se}),(null!==(le=globalThis.litElementVersions)&&void 0!==le?le:globalThis.litElementVersions=[]).push("3.3.1");const ce=e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:o,elements:i}=t;return{kind:o,elements:i,finisher(t){customElements.define(e,t)}}})(e,t),ue=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(o){o.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(o){o.createProperty(t.key,e)}};function ve(e){return(t,o)=>void 0!==o?((e,t,o)=>{t.constructor.createProperty(o,e)})(e,t,o):ue(e,t)}function _e(e){return ve({...e,state:!0})}function he(e,t){return(({finisher:e,descriptor:t})=>(o,i)=>{var a;if(void 0===i){const i=null!==(a=o.originalKey)&&void 0!==a?a:o.key,r=null!=t?{kind:"method",placement:"prototype",key:i,descriptor:t(o.key)}:{...o,key:i};return null!=e&&(r.finisher=function(t){e(t,i)}),r}{const a=o.constructor;void 0!==t&&Object.defineProperty(o,i,t(i)),null==e||e(a,i)}})({descriptor:o=>{const i={get(){var t,o;return null!==(o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(e))&&void 0!==o?o:null},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof o?Symbol():"__"+o;i.get=function(){var o,i;return void 0===this[t]&&(this[t]=null!==(i=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(e))&&void 0!==i?i:null),this[t]}}return i}})}var pe;null===(pe=window.HTMLSlotElement)||void 0===pe||pe.prototype.assignedElements;class ye{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,o){this._$Ct=e,this._$AM=t,this._$Ci=o}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}}const me=(e=>(...t)=>({_$litDirective$:e,values:t}))(class extends ye{constructor(e){var t;if(super(e),1!==e.type||"class"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){var o,i;if(void 0===this.it){this.it=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!(null===(o=this.nt)||void 0===o?void 0:o.has(e))&&this.it.add(e);return this.render(t)}const a=e.element.classList;this.it.forEach((e=>{e in t||(a.remove(e),this.it.delete(e))}));for(const e in t){const o=!!t[e];o===this.it.has(e)||(null===(i=this.nt)||void 0===i?void 0:i.has(e))||(o?(a.add(e),this.it.add(e)):(a.remove(e),this.it.delete(e)))}return W}}),fe=(e,t)=>Number(`${Math.round(Number(`${e}e${t}`))}e-${t}`);function ge(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}function be(e,t=0){return ge(e)?Number(e):t}var we="0.1.6";console.groupCollapsed(`%c⚡ Power Flow Card Plus v${we} is installed`,"color: #488fc2; font-weight: bold"),console.log("Readme:","https://github.com/flixlix/power-flow-card-plus"),console.groupEnd();const xe=function(e,t,o){var i;return void 0===o&&(o=!1),function(){var t=[].slice.call(arguments),a=this,r=o&&!i;clearTimeout(i),i=setTimeout((function(){i=null,o||e.apply(a,t)}),6e4),r&&e.apply(a,t)}}((e=>{console.log(`%c⚡ Power Flow Card Plus v${we} %cError: ${e}`,"color: #488fc2; font-weight: bold","color: #b33a3a; font-weight: normal")})),$e=u`:host{--mdc-icon-size:24px;--clickable-cursor:pointer;--individualone-color:#d0cc5b;--individualtwo-color:#964cb5;--non-fossil-color:var(--energy-non-fossil-color, #0f9d58);--icon-non-fossil-color:var(--non-fossil-color, #0f9d58);--icon-solar-color:var(--energy-solar-color, #ff9800);--icon-individualone-color:var(--individualone-color, #d0cc5b);--icon-individualtwo-color:var(--individualtwo-color, #964cb5);--icon-grid-color:var(--energy-grid-consumption-color, #488fc2);--icon-battery-color:var(--energy-battery-in-color, #f06292);--icon-home-color:var(--energy-grid-consumption-color, #488fc2);--text-solar-color:var(--primary-text-color);--text-non-fossil-color:var(--primary-text-color);--text-individualone-color:var(--primary-text-color);--text-individualtwo-color:var(--primary-text-color);--text-home-color:var(--primary-text-color);--secondary-text-individualone-color:var(--primary-text-color);--secondary-text-individualtwo-color:var(--primary-text-color);--text-battery-state-of-charge-color:var(--primary-text-color);--cirlce-grid-color:var(--energy-grid-consumption-color, #488fc2);--circle-battery-color:var(--energy-battery-in-color, #f06292);--secondary-text-solar-color:var(--primary-text-color);--secondary-text-grid-color:var(--primary-text-color);--secondary-text-home-color:var(--primary-text-color);--secondary-text-non-fossil-color:var(--primary-text-color);--lines-svg-not-flat-line-height:106%;--lines-svg-not-flat-line-top:-3%;--lines-svg-flat-width:calc(100% - 160px);--lines-svg-not-flat-width:calc(103% - 165px);--transparency:var(--transparency-unused-lines);--greyed-out--line-color:#bdbdbd}ha-card.full-size{height:100%}.card-content.full-size{transform:scale(2) translateY(30%)}.card-content{position:relative;margin:0 auto}.card-content,.row{max-width:470px}.lines{position:absolute;bottom:0;left:0;width:100%;height:146px;display:flex;justify-content:center;padding:0 16px 16px;box-sizing:border-box}.lines.individual1-individual2{bottom:110px}.lines.high{bottom:100px;height:156px}.lines svg{width:var(--lines-svg-flat-width);height:100%;max-width:340px}.lines svg:not(.flat-line){width:var(--lines-svg-not-flat-width);height:var(--lines-svg-not-flat-line-height);top:var(--lines-svg-not-flat-line-top);position:relative}.row{display:flex;justify-content:space-between;max-width:500px;margin:0 auto}.circle-container{display:flex;flex-direction:column;align-items:center;z-index:2}.circle-container.solar{margin:0 4px;height:130px}.circle-container.individual2{margin-left:4px;height:130px}.circle-container.individual1{margin-left:4px;height:130px}.circle-container.individual1.bottom{position:relative;top:-20px;margin-bottom:-20px}.circle-container.battery{height:110px;justify-content:flex-end}.spacer{width:84px}.circle{width:80px;height:80px;border-radius:50%;box-sizing:border-box;border:2px solid;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;font-size:12px;line-height:12px;position:relative;text-decoration:none;color:var(--primary-text-color)}.circle-container .circle{cursor:var(--clickable-cursor)}#battery-grid{stroke:var(--energy-grid-return-color)}ha-icon{padding-bottom:2px}ha-icon.small{--mdc-icon-size:12px}.label{color:var(--secondary-text-color);font-size:12px;max-width:80px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;min-height:20px}line,path{stroke:var(--disabled-text-color);stroke-width:1;fill:none}path.transparency{opacity:calc(calc(100 - var(--transparency))/ 100)}path.grey{stroke:var(--greyed-out--line-color)!important}.circle svg{position:absolute;fill:none;stroke-width:4px;width:100%;height:100%;top:0;left:0}span.secondary-info{color:var(--primary-text-color);font-size:12px;max-width:60px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.individual2 circle,.individual2 path{stroke:var(--individualtwo-color)}#individual1-icon{color:var(--icon-individualone-color)}#individual2-icon{color:var(--icon-individualtwo-color)}#solar-icon{color:var(--icon-solar-color)}circle.individual2{stroke-width:4;fill:var(--individualtwo-color)}.individual2 .circle{border-color:var(--individualtwo-color)}.individual1 circle,.individual1 path{stroke:var(--individualone-color)}circle.individual1{stroke-width:4;fill:var(--individualone-color)}.individual1 .circle{border-color:var(--individualone-color)}.circle-container.low-carbon{margin-right:4px;height:130px}.low-carbon path{stroke:var(--non-fossil-color)}.low-carbon .circle{border-color:var(--non-fossil-color)}.low-carbon ha-icon:not(.small){color:var(--icon-non-fossil-color)}circle.low-carbon{stroke-width:4;fill:var(--non-fossil-color);stroke:var(--non-fossil-color)}.solar{color:var(--primary-text-color)}.solar .circle{border-color:var(--energy-solar-color)}.solar ha-icon:not(.small){color:var(--icon-solar-color)}circle.solar,path.solar{stroke:var(--energy-solar-color)}circle.solar{stroke-width:4;fill:var(--energy-solar-color)}.battery .circle{border-color:var(--circle-battery-color)}circle.battery,path.battery{stroke:var(--energy-battery-out-color)}circle.battery-home,path.battery-home{stroke:var(--energy-battery-out-color)}circle.battery-home{stroke-width:4;fill:var(--energy-battery-out-color)}circle.battery-solar,path.battery-solar{stroke:var(--energy-battery-in-color)}circle.battery-solar{stroke-width:4;fill:var(--energy-battery-in-color)}.battery-in{color:var(--energy-battery-in-color)}.battery-out{color:var(--energy-battery-out-color)}path.battery-from-grid{stroke:var(--energy-grid-consumption-color)}path.battery-to-grid{stroke:var(--energy-grid-return-color)}.battery ha-icon:not(.small){color:var(--icon-battery-color)}circle.battery-to-grid,circle.return,path.return{stroke:var(--energy-grid-return-color)}circle.battery-to-grid,circle.return{stroke-width:4;fill:var(--energy-grid-return-color)}.return{color:var(--energy-grid-return-color)}.grid .circle{border-color:var(--circle-grid-color)}.consumption{color:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid,path.grid{stroke:var(--energy-grid-consumption-color)}circle.battery-from-grid,circle.grid{stroke-width:4;fill:var(--energy-grid-consumption-color)}.grid ha-icon:not(.small){color:var(--icon-grid-color)}.home .circle{border-width:0;border-color:var(--primary-color)}.home .circle.border{border-width:2px}.home ha-icon:not(.small){color:var(--icon-home-color)}.circle svg circle{animation:rotate-in .6s ease-in;transition:stroke-dashoffset .4s,stroke-dasharray .4s;fill:none}span.solar{color:var(--text-solar-color)}span.low-carbon{color:var(--text-non-fossil-color)}span.nonFossilFuel.secondary-info{color:var(--secondary-text-non-fossil-color)}#home-circle{color:var(--text-home-color)}.individual1 .circle{color:var(--text-individualone-color)}.individual2 .circle{color:var(--text-individualtwo-color)}.individual1 span.secondary-info{color:var(--secondary-text-individualone-color)}.individual2 span.secondary-info{color:var(--secondary-text-individualtwo-color)}.solar span.secondary-info{color:var(--secondary-text-solar-color)}.grid span.secondary-info{color:var(--secondary-text-grid-color)}.home span.secondary-info{color:var(--secondary-text-home-color)}#battery-state-of-charge-text{color:var(--text-battery-state-of-charge-color)}@keyframes rotate-in{from{stroke-dashoffset:238.76104;stroke-dasharray:238.76104}}.card-actions a{text-decoration:none}.home-circle-sections{pointer-events:none}`,ke={maxFlowRate:6,minFlowRate:.75,wattDecimals:0,kilowattDecimals:1,minExpectedPower:.01,maxExpectedPower:2e3,wattThreshold:1e3,transparencyZeroLines:0,displayZeroLines:{mode:"show",transparency:50,grey_color:[189,189,189]}};var Ee={label:{car:"Car",motorbike:"Motorbike"}},Ce={combined:"Combined Entity (One entity with positive and negative values)",separated:"Separated Entities (One entity for consumption and one for production)",custom_colors:"Custom Colors",secondary_info:"Secondary Info",power_outage:"Power Outage",grid:"Grid",solar:"Solar",battery:"Battery",fossil_fuel_percentage:"Fossil Fuel",home:"Home",individual:"Individual",advanced:"Advanced Options",decimals:"Decimals",consumption:"Consumption",production:"Production",color_icon:"Color of Icon",color_circle:"Color of Circle",color_value:"Color of Value",color_state_of_charge_value:"Color",display_zero:"Display Zero",display_zero_tolerance:"Display Zero Tolerance",display_state:"Display State",display_zero_state:"Display Zero State",invert_state:"Invert State",template:"Template",unit_of_measurement:"Unit",unit_white_space:"Unit White Space",label_alert:"Label for Alert",icon_alert:"Icon for Alert",state_alert:"State of Alert",state_of_charge:"State of Charge",state_of_charge_unit_white_space:"White Space",state_of_charge_unit:"Unit",state_of_charge_decimals:"Decimals",state_of_charge_icon:"Icon",state_type:"Type of State",subtract_individual:"Subtract Individual",override_state:"Override State",calculate_flow_rate:"Calculate Flow Rate",inverted_animation:"Invert Animation",show_direction:"Show Direction",color:"Color",dashboard_link:"Dashboard Link",dashboard_link_label:"Dashboard Link Name",w_decimals:"Watt Decimals",kw_decimals:"Kilowatt Decimals",max_flow_rate:"Max Flow Rate",min_flow_rate:"Min Flow Rate",max_expected_power:"Max Expected Power",min_expected_power:"Min Expected Power",watt_threshold:"Watt to Kilowatt Threshold",display_zero_lines:"Display Zero Lines",clickable_entities:"Clickable Entities",use_new_flow_rate_model:"New Flow Rate Model",use_metadata:"Use Metadata",mode:"Mode",show:"Show",hide:"Hide",custom:"Custom",grey_out:"Grey Out",transparency:"Transparency",grey_color:"Grey Color"},ze={card:Ee,editor:Ce},Se={label:{car:"Auto",motorbike:"Motorrad"}},Me={combined:"Kombinierte Entität (Eine Entität mit positiven und negativen Werten)",separated:"Getrennte Entitäten (Eine Entität für den Verbrauch und eine für die Produktion)",custom_colors:"Benutzerdefinierte Farben",secondary_info:"Sekundäre Information",power_outage:"Stromausfall",grid:"Netz",solar:"Solar",battery:"Batterie",fossil_fuel_percentage:"Fossile Brennstoffe",home:"Zuhause",individual:"Individuell",advanced:"Erweiterte Optionen",decimals:"Dezimalstellen",consumption:"Verbrauch",production:"Produktion",color_icon:"Farbe des Symbols",color_circle:"Farbe des Kreises",color_value:"Farbe des Wertes",color_state_of_charge_value:"Farbe",display_zero:"Null anzeigen",display_zero_tolerance:"Nulltoleranz",display_state:"Zustand anzeigen",display_zero_state:"Nullzustand anzeigen",invert_state:"Zustand umkehren",template:"Vorlage",unit_of_measurement:"Einheit",unit_white_space:"Weißraum für Einheit",label_alert:"Beschriftung für Alarm",icon_alert:"Symbol für Alarm",state_alert:"Alarmzustand",state_of_charge:"Ladezustand",state_of_charge_unit_white_space:"Leerzeichen",state_of_charge_unit:"Einheit",state_of_charge_decimals:"Dezimalstellen",state_of_charge_icon:"Symbol",state_type:"Typ des Zustands",subtract_individual:"Individuell abziehen",override_state:"Zustand überschreiben",calculate_flow_rate:"Flussrate berechnen",inverted_animation:"Animation umkehren",show_direction:"Richtung anzeigen",color:"Farbe",dashboard_link:"Dashboard-Link",dashboard_link_label:"Name des Dashboard-Links",w_decimals:"Watt-Dezimalstellen",kw_decimals:"Kilowatt-Dezimalstellen",max_flow_rate:"Maximale Flussrate",min_flow_rate:"Minimale Flussrate",max_expected_power:"Maximale erwartete Leistung",min_expected_power:"Minimale erwartete Leistung",watt_threshold:"Watt-zu-Kilowatt-Schwelle",display_zero_lines:"Nulllinien anzeigen",clickable_entities:"Klickbare Entitäten",use_new_flow_rate_model:"Neues Fluss-Modell verwenden",use_metadata:"Metadaten verwenden",mode:"Modus",show:"Anzeigen",hide:"Verstecken",custom:"Benutzerdefiniert",grey_out:"Ausgrauen",transparency:"Transparenz",grey_color:"Graue Farbe"},Ae={card:Se,editor:Me},Pe={label:{car:"Carro",motorbike:"Mota"}},De={combined:"Entidade combinada (uma entidade com valores positivos e negativos)",separated:"Entidades Separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação Secundária",power_outage:"Falta de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustíveis Fósseis",home:"Casa",individual:"Individual",advanced:"Opções Avançadas",decimals:"Casas Decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do Ícone",color_circle:"Cor do Círculo",color_value:"Cor do Valor",color_state_of_charge_value:"Cor",display_zero:"Mostrar Zero",display_zero_tolerance:"Tolerância do Zero",display_state:"Mostrar Estado",display_zero_state:"Mostrar Estado Zero",invert_state:"Inverter Estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaçamento da Unidade",label_alert:"Nome para Alerta",icon_alert:"Ícone para Alerta",state_alert:"Estado do Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espaçamento",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas Decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de Estado",subtract_individual:"Subtrair Individualmente",override_state:"Substituir Estado",calculate_flow_rate:"Calcular Taxa de Fluxo",inverted_animation:"Animação Invertida",show_direction:"Mostrar Direção",color:"Cor",dashboard_link:"Link do Painel de Controlo",dashboard_link_label:"Nome do Link do Painel de Controlo",w_decimals:"Casas Decimais de Watt",kw_decimals:"Casas Decimais de Quilowatt",max_flow_rate:"Taxa de Fluxo Máxima",min_flow_rate:"Taxa de Fluxo Mínima",max_expected_power:"Potência Máxima Esperada",min_expected_power:"Potência Mínima Esperada",watt_threshold:"Limiar de Watt para Quilowatt",display_zero_lines:"Mostrar Linhas Zero",clickable_entities:"Entidades Clicáveis",use_new_flow_rate_model:"Utilizar Novo Modelo de Velocidade",use_metadata:"Utilizar Metadados",mode:"Modo",show:"Mostrar",hide:"Esconder",custom:"Personalizado",grey_out:"Cinzento",transparency:"Transparência",grey_color:"Cor Cinzenta"},Te={card:Pe,editor:De},Oe={label:{car:"Carro",motorbike:"Mota"}},je={combined:"Entidade combinada (uma entidade com valores positivos e negativos)",separated:"Entidades Separadas (Uma entidade para consumo e outra para produção)",custom_colors:"Cores personalizadas",secondary_info:"Informação Secundária",power_outage:"Falta de energia",grid:"Rede",solar:"Solar",battery:"Bateria",fossil_fuel_percentage:"Combustíveis Fósseis",home:"Casa",individual:"Individual",advanced:"Opções Avançadas",decimals:"Casas Decimais",consumption:"Consumo",production:"Produção",color_icon:"Cor do Ícone",color_circle:"Cor do Círculo",color_value:"Cor do Valor",color_state_of_charge_value:"Cor",display_zero:"Exibir Zero",display_zero_tolerance:"Tolerância de Zero",display_state:"Exibir Estado",display_zero_state:"Exibir Estado Zero",invert_state:"Inverter Estado",template:"Modelo",unit_of_measurement:"Unidade",unit_white_space:"Espaçamento da Unidade",label_alert:"Rótulo para Alerta",icon_alert:"Ícone para Alerta",state_alert:"Estado do Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espaçamento",state_of_charge_unit:"Unidade",state_of_charge_decimals:"Casas Decimais",state_of_charge_icon:"Ícone",state_type:"Tipo de Estado",subtract_individual:"Subtrair Individualmente",override_state:"Substituir Estado",calculate_flow_rate:"Calcular Taxa de Fluxo",inverted_animation:"Animação Invertida",show_direction:"Mostrar Direção",color:"Cor",dashboard_link:"Link do Painel",dashboard_link_label:"Nome do Link do Painel",w_decimals:"Casas Decimais de Watts",kw_decimals:"Casas Decimais de Quilowatts",max_flow_rate:"Taxa de Fluxo Máxima",min_flow_rate:"Taxa de Fluxo Mínima",max_expected_power:"Potência Máxima Esperada",min_expected_power:"Potência Mínima Esperada",watt_threshold:"Limiar de Watts para Quilowatts",display_zero_lines:"Exibir Linhas Zero",clickable_entities:"Entidades Clicáveis",use_new_flow_rate_model:"Utilizar Novo Modelo de Velocidade",use_metadata:"Utilizar Metadados",mode:"Modo",show:"Mostrar",hide:"Esconder",custom:"Personalizado",grey_out:"Cinza",transparency:"Transparência",grey_color:"Cor do Cinza"},Ne={card:Oe,editor:je},Ge={label:{car:"Coche",motorbike:"Motocicleta"}},Be={combined:"Entidad combinada (una entidad con valores positivos y negativos)",separated:"Entidades separadas (una entidad de consumo y otra de producción)",custom_colors:"Colores personalizados",secondary_info:"Información secundaria",power_outage:"Corte de energía",grid:"Red eléctrica",solar:"Solar",battery:"Batería",fossil_fuel_percentage:"Combustible Fósil",home:"Inicio",individual:"Individual",advanced:"Opciones Avanzadas",decimals:"Decimales",consumption:"Consumo",production:"Producción",color_icon:"Color del Icono",color_circle:"Color del Círculo",color_value:"Color del Valor",color_state_of_charge_value:"Color",display_zero:"Mostrar Cero",display_zero_tolerance:"Tolerancia de Cero",display_state:"Mostrar Estado",display_zero_state:"Mostrar Estado Cero",invert_state:"Invertir Estado",template:"Plantilla",unit_of_measurement:"Unidad",unit_white_space:"Espacio en Blanco de la Unidad",label_alert:"Etiqueta para Alerta",icon_alert:"Ícono para Alerta",state_alert:"Estado de Alerta",state_of_charge:"Estado de Carga",state_of_charge_unit_white_space:"Espacio en Blanco",state_of_charge_unit:"Unidad",state_of_charge_decimals:"Decimales",state_of_charge_icon:"Ícono",state_type:"Tipo de Estado",subtract_individual:"Restar Individualmente",override_state:"Sobrescribir Estado",calculate_flow_rate:"Calcular Tasa de Flujo",inverted_animation:"Animación Invertida",show_direction:"Mostrar Dirección",color:"Color",dashboard_link:"Enlace del Tablero",dashboard_link_label:"Nombre del Enlace del Tablero",w_decimals:"Decimales de Vatio",kw_decimals:"Decimales de Kilovatio",max_flow_rate:"Tasa de Flujo Máxima",min_flow_rate:"Tasa de Flujo Mínima",max_expected_power:"Potencia Máxima Esperada",min_expected_power:"Potencia Mínima Esperada",watt_threshold:"Umbral de Vatio a Kilovatio",display_zero_lines:"Mostrar Líneas de Cero",clickable_entities:"Entidades Clicables",use_new_flow_rate_model:"Utilizar Nuevo Modelo de Tasa de Flujo",use_metadata:"Utilizar Metadatos",mode:"Modo",show:"Mostrar",hide:"Ocultar",custom:"Personalizado",grey_out:"Gris",transparency:"Transparencia",grey_color:"Color Gris"},Fe={card:Ge,editor:Be},Re={label:{car:"Auto",motorbike:"Motorfiets"}},He={combined:"Gecombineerde entiteit (één entiteit met positieve en negatieve waarden)",separated:"Gescheiden entiteiten (één entiteit voor consumptie en één voor productie)",custom_colors:"Aangepaste kleuren",secondary_info:"Secundaire informatie",power_outage:"Stroomuitval",grid:"Elektriciteitsnet",solar:"Zonne-energie",battery:"Batterij",fossil_fuel_percentage:"Fossiele Brandstof",home:"Thuis",individual:"Individueel",advanced:"Geavanceerde Opties",decimals:"Decimalen",consumption:"Verbruik",production:"Productie",color_icon:"Kleur van Pictogram",color_circle:"Kleur van Cirkel",color_value:"Kleur van Waarde",color_state_of_charge_value:"Kleur",display_zero:"Nul Weergeven",display_zero_tolerance:"Nultolerantie Weergeven",display_state:"Toestand Weergeven",display_zero_state:"Nul Toestand Weergeven",invert_state:"Toestand Omkeren",template:"Sjabloon",unit_of_measurement:"Eenheid",unit_white_space:"Eenheid Spaties",label_alert:"Label voor Alarm",icon_alert:"Pictogram voor Alarm",state_alert:"Toestand van Alarm",state_of_charge:"Laadstatus",state_of_charge_unit_white_space:"Spaties",state_of_charge_unit:"Eenheid",state_of_charge_decimals:"Decimalen",state_of_charge_icon:"Pictogram",state_type:"Type Toestand",subtract_individual:"Individueel Aftrekken",override_state:"Toestand Overschrijven",calculate_flow_rate:"Stroomsnelheid Berekenen",inverted_animation:"Animatie Omkeren",show_direction:"Richting Weergeven",color:"Kleur",dashboard_link:"Dashboard Link",dashboard_link_label:"Naam van Dashboard Link",w_decimals:"Watt Decimalen",kw_decimals:"Kilowatt Decimalen",max_flow_rate:"Maximale Stroomsnelheid",min_flow_rate:"Minimale Stroomsnelheid",max_expected_power:"Maximaal Verwacht Vermogen",min_expected_power:"Minimaal Verwacht Vermogen",watt_threshold:"Watt naar Kilowatt Drempelwaarde",display_zero_lines:"Nullijnen Weergeven",clickable_entities:"Klikbare Entiteiten",use_new_flow_rate_model:"Nieuw Stroomsnelheid Model Gebruiken",use_metadata:"Metadata Gebruiken",mode:"Modus",show:"Weergeven",hide:"Verbergen",custom:"Aangepast",grey_out:"Grijstint",transparency:"Transparantie",grey_color:"Grijstint"},Le={card:Re,editor:He},Ie={label:{car:"Auto",motorbike:"Motocicletta"}},Ue={combined:"Entità combinata (un'entità con valori positivi e negativi)",separated:"Entità separate (Un'entità per il consumo e una per la produzione)",custom_colors:"Colori personalizzati",secondary_info:"Informazioni secondarie",power_outage:"Interruzione di corrente",grid:"Rete Elettrica",solar:"Solare",battery:"Batteria",fossil_fuel_percentage:"Carburante Fossile",home:"Casa",individual:"Individuale",advanced:"Opzioni Avanzate",decimals:"Decimali",consumption:"Consumo",production:"Produzione",color_icon:"Colore dell'Icona",color_circle:"Colore del Cerchio",color_value:"Colore del Valore",color_state_of_charge_value:"Colore",display_zero:"Mostra Zero",display_zero_tolerance:"Tolleranza dello Zero",display_state:"Mostra Stato",display_zero_state:"Mostra Stato Zero",invert_state:"Inverti Stato",template:"Modello",unit_of_measurement:"Unità",unit_white_space:"Spazio Bianco Unità",label_alert:"Etichetta per l'Allarme",icon_alert:"Icona per l'Allarme",state_alert:"Stato dell'Allarme",state_of_charge:"Stato di Carica",state_of_charge_unit_white_space:"Spazio Bianco",state_of_charge_unit:"Unità",state_of_charge_decimals:"Decimali",state_of_charge_icon:"Icona",state_type:"Tipo di Stato",subtract_individual:"Sottrai Individualmente",override_state:"Sovrascrivi Stato",calculate_flow_rate:"Calcola Tasso di Flusso",inverted_animation:"Animazione Invertita",show_direction:"Mostra Direzione",color:"Colore",dashboard_link:"Collegamento Dashboard",dashboard_link_label:"Nome Collegamento Dashboard",w_decimals:"Decimali Watt",kw_decimals:"Decimali Kilowatt",max_flow_rate:"Tasso di Flusso Massimo",min_flow_rate:"Tasso di Flusso Minimo",max_expected_power:"Potenza Massima Prevista",min_expected_power:"Potenza Minima Prevista",watt_threshold:"Soglia Watt per Kilowatt",display_zero_lines:"Mostra Linee Zero",clickable_entities:"Entità Cliccabili",use_new_flow_rate_model:"Utilizza Nuovo Modello di Tasso di Flusso",use_metadata:"Utilizza Metadati",mode:"Modalità",show:"Mostra",hide:"Nascondi",custom:"Personalizzato",grey_out:"Sfuma",transparency:"Trasparenza",grey_color:"Colore Sfumato"},We={card:Ie,editor:Ue},Ve={label:{car:"Voiture",motorbike:"Moto"}},Ze={combined:"Entité combinée (une entité avec des valeurs positives et négatives)",separated:"Entités séparées (une entité pour la consommation et une pour la production)",custom_colors:"Couleurs personnalisées",secondary_info:"Informations secondaires",power_outage:"Panne de courant",grid:"Réseau Électrique",solar:"Solaire",battery:"Batterie",fossil_fuel_percentage:"Carburant fossile",home:"Domicile",individual:"Individuel",advanced:"Options avancées",decimals:"Décimales",consumption:"Consommation",production:"Production",color_icon:"Couleur de l'icône",color_circle:"Couleur du cercle",color_value:"Couleur de la valeur",color_state_of_charge_value:"Couleur",display_zero:"Afficher zéro",display_zero_tolerance:"Tolérance de l'affichage zéro",display_state:"Afficher l'état",display_zero_state:"Afficher l'état zéro",invert_state:"Inverser l'état",template:"Modèle",unit_of_measurement:"Unité",unit_white_space:"Espace blanc de l'unité",label_alert:"Libellé de l'alerte",icon_alert:"Icône de l'alerte",state_alert:"État de l'alerte",state_of_charge:"État de charge",state_of_charge_unit_white_space:"Espace blanc de l'unité",state_of_charge_unit:"Unité",state_of_charge_decimals:"Décimales",state_of_charge_icon:"Icône",state_type:"Type d'état",subtract_individual:"Soustraire l'individuel",override_state:"Remplacer l'état",calculate_flow_rate:"Calculer le débit",inverted_animation:"Animation inversée",show_direction:"Afficher la direction",color:"Couleur",dashboard_link:"Lien du tableau de bord",dashboard_link_label:"Nom du lien du tableau de bord",w_decimals:"Décimales de watt",kw_decimals:"Décimales de kilowatt",max_flow_rate:"Débit maximal",min_flow_rate:"Débit minimal",max_expected_power:"Puissance maximale attendue",min_expected_power:"Puissance minimale attendue",watt_threshold:"Seuil de watt vers kilowatt",display_zero_lines:"Afficher les lignes zéro",clickable_entities:"Entités cliquables",use_new_flow_rate_model:"Nouveau modèle de débit",use_metadata:"Utiliser les métadonnées",mode:"Mode",show:"Afficher",hide:"Masquer",custom:"Personnalisé",grey_out:"Griser",transparency:"Transparence",grey_color:"Couleur grise"},Ke={card:Ve,editor:Ze},Ye={label:{car:"Автомобиль",motorbike:"Мотоцикл"}},qe={combined:"Комбинированный объект (один объект с положительными и отрицательными значениями)",separated:"Отдельные объекты (один объект для потребления и один для производства)",custom_colors:"Пользовательские цвета",secondary_info:"Вторичная информация",power_outage:"Отключение электричества",grid:"Электрическая сеть",solar:"Солнечная",battery:"Батарея",fossil_fuel_percentage:"Полный объем ископаемого топлива",home:"Домашняя",individual:"Индивидуальная",advanced:"Расширенные настройки",decimals:"Десятичные",consumption:"Потребление",production:"Производство",color_icon:"Цвет иконки",color_circle:"Цвет круга",color_value:"Цвет значения",color_state_of_charge_value:"Цвет",display_zero:"Отображать ноль",display_zero_tolerance:"Допустимая погрешность нуля",display_state:"Отображать состояние",display_zero_state:"Отображать состояние нуля",invert_state:"Инвертировать состояние",template:"Шаблон",unit_of_measurement:"Единица измерения",unit_white_space:"Пробел единицы измерения",label_alert:"Метка для предупреждения",icon_alert:"Иконка для предупреждения",state_alert:"Состояние предупреждения",state_of_charge:"Уровень заряда",state_of_charge_unit_white_space:"Пробел",state_of_charge_unit:"Единица измерения",state_of_charge_decimals:"Десятичные",state_of_charge_icon:"Иконка",state_type:"Тип состояния",subtract_individual:"Вычесть индивидуально",override_state:"Переопределить состояние",calculate_flow_rate:"Рассчитать скорость потока",inverted_animation:"Инвертированная анимация",show_direction:"Показать направление",color:"Цвет",dashboard_link:"Ссылка на панель управления",dashboard_link_label:"Название ссылки на панель управления",w_decimals:"Десятичные ватт",kw_decimals:"Десятичные киловатт",max_flow_rate:"Максимальная скорость потока",min_flow_rate:"Минимальная скорость потока",max_expected_power:"Максимальная ожидаемая мощность",min_expected_power:"Минимальная ожидаемая мощность",watt_threshold:"Пороговое значение ватт в киловатты",display_zero_lines:"Отображать нулевые линии",clickable_entities:"Кликабельные сущности",use_new_flow_rate_model:"Использовать новую модель скорости потока",use_metadata:"Использовать метаданные",mode:"Режим",show:"Показать",hide:"Скрыть",custom:"Пользовательский",grey_out:"Серый",transparency:"Прозрачность",grey_color:"Серый цвет"},Je={card:Ye,editor:qe},Qe={label:{car:"Auto",motorbike:"Moottoripyörä"}},Xe={combined:"Yhdistetty kokonaisuus (yksi kokonaisuus positiivisilla ja negatiivisilla arvoilla)",separated:"Erotetut kokonaisuudet (yksi kulutukseen ja yksi tuotantoon)",custom_colors:"Mukautetut värit",secondary_info:"Toissijaiset tiedot",power_outage:"Sähkökatkos",grid:"Sähköverkko",solar:"Aurinko",battery:"Akku",fossil_fuel_percentage:"Fossiilinen polttoaine",home:"Koti",individual:"Yksittäinen",advanced:"Lisäasetukset",decimals:"Desimaalit",consumption:"Kulutus",production:"Tuotanto",color_icon:"Ikonin väri",color_circle:"Ympyrän väri",color_value:"Arvon väri",color_state_of_charge_value:"Väri",display_zero:"Näytä nolla",display_zero_tolerance:"Näytä nolla-toleranssi",display_state:"Näytä tila",display_zero_state:"Näytä nolla-tila",invert_state:"Käänteinen tila",template:"Malli",unit_of_measurement:"Yksikkö",unit_white_space:"Yksikön välilyönti",label_alert:"Hälytyksen teksti",icon_alert:"Hälytyksen kuvake",state_alert:"Hälytyksen tila",state_of_charge:"Varauksen tila",state_of_charge_unit_white_space:"Välilyönti",state_of_charge_unit:"Yksikkö",state_of_charge_decimals:"Desimaalit",state_of_charge_icon:"Kuvake",state_type:"Tilan tyyppi",subtract_individual:"Vähennä yksittäinen",override_state:"Korvaa tila",calculate_flow_rate:"Laske virtausnopeus",inverted_animation:"Käänteinen animaatio",show_direction:"Näytä suunta",color:"Väri",dashboard_link:"Ohjauspaneelin linkki",dashboard_link_label:"Ohjauspaneelin linkin nimi",w_decimals:"Wattien desimaalit",kw_decimals:"Kilowattien desimaalit",max_flow_rate:"Maksimivirtausnopeus",min_flow_rate:"Minimivirtausnopeus",max_expected_power:"Ennustettu maksimiteho",min_expected_power:"Ennustettu minimiteho",watt_threshold:"Wattin ja kilowatin kynnysarvo",display_zero_lines:"Näytä nolla-viivat",clickable_entities:"Napautettavat kohteet",use_new_flow_rate_model:"Uusi virtausnopeusmalli",use_metadata:"Käytä metatietoja",mode:"Tila",show:"Näytä",hide:"Piilota",custom:"Mukautettu",grey_out:"Harmaa",transparency:"Läpinäkyvyys",grey_color:"Harmaa väri"},et={card:Qe,editor:Xe},tt={label:{car:"Samochód",motorbike:"Motocykl"}},ot={combined:"Jednostka połączona (jedna jednostka z wartościami dodatnimi i ujemnymi)",separated:"Oddzielne podmioty (jeden podmiot do konsumpcji i jeden do produkcji)",custom_colors:"Kolory niestandardowe",secondary_info:"Informacje dodatkowe",power_outage:"Brak prądu",grid:"Sieć elektryczna",solar:"Energia słoneczna",battery:"Bateria",fossil_fuel_percentage:"Paliwo kopalne",home:"Dom",individual:"Indywidualne",advanced:"Zaawansowane opcje",decimals:"Miejsca po przecinku",consumption:"Zużycie",production:"Produkcja",color_icon:"Kolor ikony",color_circle:"Kolor okręgu",color_value:"Kolor wartości",color_state_of_charge_value:"Kolor",display_zero:"Wyświetl zero",display_zero_tolerance:"Wyświetl tolerancję zera",display_state:"Wyświetl stan",display_zero_state:"Wyświetl stan zera",invert_state:"Odwróć stan",template:"Szablon",unit_of_measurement:"Jednostka",unit_white_space:"Spacja jednostki",label_alert:"Etykieta alertu",icon_alert:"Ikona alertu",state_alert:"Stan alertu",state_of_charge:"Stan naładowania",state_of_charge_unit_white_space:"Spacja jednostki",state_of_charge_unit:"Jednostka",state_of_charge_decimals:"Miejsca po przecinku",state_of_charge_icon:"Ikona",state_type:"Typ stanu",subtract_individual:"Odjęcie indywidualne",override_state:"Nadpisanie stanu",calculate_flow_rate:"Oblicz wskaźnik przepływu",inverted_animation:"Odwróć animację",show_direction:"Pokaż kierunek",color:"Kolor",dashboard_link:"Link do panelu",dashboard_link_label:"Nazwa linku do panelu",w_decimals:"Miejsca po przecinku dla watów",kw_decimals:"Miejsca po przecinku dla kilowatów",max_flow_rate:"Maksymalna szybkość przepływu",min_flow_rate:"Minimalna szybkość przepływu",max_expected_power:"Maksymalna oczekiwana moc",min_expected_power:"Minimalna oczekiwana moc",watt_threshold:"Próg watów na kilowaty",display_zero_lines:"Wyświetl linie zera",clickable_entities:"Klikalne jednostki",use_new_flow_rate_model:"Nowy model wskaźnika przepływu",use_metadata:"Użyj metadanych",mode:"Tryb",show:"Pokaż",hide:"Ukryj",custom:"Niestandardowy",grey_out:"Szary",transparency:"Przezroczystość",grey_color:"Kolor szary"},it={card:tt,editor:ot};const at={en:Object.freeze({__proto__:null,card:Ee,editor:Ce,default:ze}),de:Object.freeze({__proto__:null,card:Se,editor:Me,default:Ae}),pt:Object.freeze({__proto__:null,card:Pe,editor:De,default:Te}),pt_BR:Object.freeze({__proto__:null,card:Oe,editor:je,default:Ne}),es:Object.freeze({__proto__:null,card:Ge,editor:Be,default:Fe}),nl:Object.freeze({__proto__:null,card:Re,editor:He,default:Le}),it:Object.freeze({__proto__:null,card:Ie,editor:Ue,default:We}),fr:Object.freeze({__proto__:null,card:Ve,editor:Ze,default:Ke}),ru:Object.freeze({__proto__:null,card:Ye,editor:qe,default:Je}),fi:Object.freeze({__proto__:null,card:Qe,editor:Xe,default:et}),pl:Object.freeze({__proto__:null,card:tt,editor:ot,default:it})},rt="en";function nt(e,t){try{return e.split(".").reduce(((e,t)=>e[t]),at[t])}catch(e){return}}function lt(e){let t=nt(e,(localStorage.getItem("selectedLanguage")||"en").replace(/['"]+/g,"").replace("-","_"));return t||(t=nt(e,rt)),null!=t?t:e}const st=238.76104;!function(e){const t=window;t.customCards=t.customCards||[],t.customCards.push(Object.assign(Object.assign({},{type:"power-flow-card-plus",name:"Power Flow Card Plus",description:"An extended version of the power flow card with richer options, advanced features and a few small UI enhancements. Inspired by the Energy Dashboard."}),{preview:!0,documentationURL:"https://github.com/flixlix/power-flow-card-plus"}))}();let dt=class extends se{constructor(){super(...arguments),this._config={},this._templateResults={},this._unsubRenderTemplates=new Map,this._width=0,this.unavailableOrMisconfiguredError=e=>xe(`Entity "${null!=e?e:"Unknown"}" is not available or misconfigured`),this.entityExists=e=>e in this.hass.states,this.entityAvailable=e=>{var t;return ge(null===(t=this.hass.states[e])||void 0===t?void 0:t.state)},this.entityInverted=e=>{var t;return!!(null===(t=this._config.entities[e])||void 0===t?void 0:t.invert_state)},this.previousDur={},this.circleRate=(e,t)=>{var o,i;if(this._config.use_new_flow_rate_model){const t=this._config.max_expected_power,o=this._config.min_expected_power,i=this._config.max_flow_rate,a=this._config.min_flow_rate;return this.mapRange(e,i,a,o,t)}const a=null===(o=this._config)||void 0===o?void 0:o.min_flow_rate,r=null===(i=this._config)||void 0===i?void 0:i.max_flow_rate;return r-e/(t>0?t:e)*(r-a)},this.getEntityStateObj=e=>{if(e&&this.entityAvailable(e))return this.hass.states[e];this.unavailableOrMisconfiguredError(e)},this.additionalCircleRate=(e,t)=>!0===e&&t?t:ge(e)?e:1.66,this.getEntityState=e=>e&&this.entityAvailable(e)?be(this.hass.states[e].state):(this.unavailableOrMisconfiguredError(e),0),this.getEntityStateWatts=e=>{var t;if(!e||!this.entityAvailable(e))return this.unavailableOrMisconfiguredError(e),0;const o=this.hass.states[e],i=be(o.state);return(null===(t=o.attributes.unit_of_measurement)||void 0===t?void 0:t.toUpperCase().startsWith("KW"))?1e3*i:i},this.displayNonFossilState=(e,t)=>{var o,i,a,r,n,l,s;if(!e||!this.entityAvailable(e))return this.unavailableOrMisconfiguredError(e),"NaN";const d=null===(i=null===(o=this._config.entities.fossil_fuel_percentage)||void 0===o?void 0:o.unit_white_space)||void 0===i||i,c="percentage"===(null===(a=this._config.entities.fossil_fuel_percentage)||void 0===a?void 0:a.state_type)?"%":"W",u=1-this.getEntityState(e)/100;let v,_;v="string"==typeof(null===(r=this._config.entities.grid)||void 0===r?void 0:r.entity)?t:this.getEntityStateWatts(null===(n=this._config.entities.grid)||void 0===n?void 0:n.entity.consumption)||0;const h=null!==(s=null===(l=this._config.entities.fossil_fuel_percentage)||void 0===l?void 0:l.display_zero_tolerance)&&void 0!==s?s:0;if("W"===c){let e=v*u;h&&e<h&&(e=0),_=this.displayValue(e,void 0,d)}else{let t=100-this.getEntityState(e);h&&t<h&&(t=0),_=this.displayValue(t,c,d,0)}return _},this.displayValue=(e,t,o,i)=>{if(null===e)return"0";if(Number.isNaN(+e))return e.toString();const r=Number(e),n=void 0===t&&r>=this._config.watt_threshold;return`${a(n?fe(r/1e3,this._config.kw_decimals):fe(r,null!=i?i:this._config.w_decimals),this.hass.locale)}${!1===o?"":" "}${t||(n?"kW":"W")}`}}setConfig(e){var t,o,i,a,r,n,l,s,d,c,u;if(!e.entities||!(null===(o=null===(t=e.entities)||void 0===t?void 0:t.battery)||void 0===o?void 0:o.entity)&&!(null===(a=null===(i=e.entities)||void 0===i?void 0:i.grid)||void 0===a?void 0:a.entity)&&!(null===(n=null===(r=e.entities)||void 0===r?void 0:r.solar)||void 0===n?void 0:n.entity))throw new Error("At least one entity for battery, grid or solar must be defined");this._config=Object.assign(Object.assign({},e),{kw_decimals:be(e.kw_decimals,ke.kilowattDecimals),min_flow_rate:be(e.min_flow_rate,ke.minFlowRate),max_flow_rate:be(e.max_flow_rate,ke.maxFlowRate),w_decimals:be(e.w_decimals,ke.wattDecimals),watt_threshold:be(e.watt_threshold,ke.wattThreshold),max_expected_power:be(e.max_expected_power,ke.maxExpectedPower),min_expected_power:be(e.min_expected_power,ke.minExpectedPower),display_zero_lines:{mode:null!==(s=null===(l=e.display_zero_lines)||void 0===l?void 0:l.mode)&&void 0!==s?s:ke.displayZeroLines.mode,transparency:be(null===(d=e.display_zero_lines)||void 0===d?void 0:d.transparency,ke.displayZeroLines.transparency),grey_color:null!==(u=null===(c=e.display_zero_lines)||void 0===c?void 0:c.grey_color)&&void 0!==u?u:ke.displayZeroLines.grey_color}})}connectedCallback(){super.connectedCallback(),this._tryConnectAll()}disconnectedCallback(){this._tryDisconnectAll()}static async getConfigElement(){return await Promise.resolve().then((function(){return to})),document.createElement("power-flow-card-plus-editor")}static getStubConfig(e){return function(e){function t(t,o){const i=e.states[t].attributes.friendly_name;return o.some((e=>t.includes(e)||(null==i?void 0:i.includes(e))))}const o=Object.keys(e.states).filter((t=>{const o=e.states[t];return o.state&&o.attributes&&"power"===o.attributes.device_class||o.entity_id.includes("power")})),i=["grid","utility","net","meter"],a=["solar","pv","photovoltaic","inverter"],r=["battery"],n=["battery_percent","battery_level","state_of_charge","soc","percentage"],l=o.filter((e=>t(e,i)))[0],s=o.filter((e=>t(e,a)))[0],d=o.filter((e=>t(e,r)))[0],c=Object.keys(e.states).filter((t=>{const o=e.states[t];return o&&o.state&&o.attributes&&"%"===o.attributes.unit_of_measurement})).filter((e=>t(e,n)))[0];return{entities:{battery:{entity:null!=d?d:"",state_of_charge:null!=c?c:""},grid:l?{entity:l}:void 0,solar:s?{entity:s,display_zero_state:!0}:void 0},clickable_entities:!0,display_zero_lines:!0,use_new_flow_rate_model:!0,w_decimals:ke.wattDecimals,kw_decimals:ke.kilowattDecimals,min_flow_rate:ke.minFlowRate,max_flow_rate:ke.maxFlowRate,max_expected_power:ke.maxExpectedPower,min_expected_power:ke.minExpectedPower,watt_threshold:ke.wattThreshold,transparency_zero_lines:ke.transparencyZeroLines}}(e)}getCardSize(){return 3}mapRange(e,t,o,i,a){return e>a?o:(e-i)*(o-t)/(a-i)+t}openDetails(e,t){if(e.stopPropagation(),!t||!this._config.clickable_entities)return;if(!this.entityExists(t))return;const o=new CustomEvent("hass-more-info",{composed:!0,detail:{entityId:t}});this.dispatchEvent(o)}hasField(e,t){var o,i;return!!(void 0!==e&&!0===(null==e?void 0:e.display_zero)||Math.abs(this.getEntityStateWatts(null==e?void 0:e.entity))>(null!==(o=null==e?void 0:e.display_zero_tolerance)&&void 0!==o?o:0)&&this.entityAvailable(null==e?void 0:e.entity)||t)&&"string"==typeof(null===(i=this.hass.states[null==e?void 0:e.entity])||void 0===i?void 0:i.state)}showLine(e){var t,o;return e>0||"hide"!==(null===(o=null===(t=this._config)||void 0===t?void 0:t.display_zero_lines)||void 0===o?void 0:o.mode)}styleLine(e){var t,o,i,a;if(e>0)return"";const r=null===(o=null===(t=this._config)||void 0===t?void 0:t.display_zero_lines)||void 0===o?void 0:o.mode;if("show"===r||void 0===r)return"";let n="";if("transparency"===r||"custom"===r){const e=null===(a=null===(i=this._config)||void 0===i?void 0:i.display_zero_lines)||void 0===a?void 0:a.transparency;(null==e||e)&&(n+="transparency ")}return"grey_out"!==r&&"custom"!==r||(n+="grey"),n}computeFieldIcon(e,t){var o,i;return(null==e?void 0:e.icon)?e.icon:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.icon)||"":t}computeFieldName(e,t){var o,i;return(null==e?void 0:e.name)?e.name:(null==e?void 0:e.use_metadata)?(null===(i=null===(o=this.getEntityStateObj(e.entity))||void 0===o?void 0:o.attributes)||void 0===i?void 0:i.friendly_name)||"":t}convertColorListToHex(e){return"#".concat(e.map((e=>e.toString(16).padStart(2,"0"))).join(""))}render(){var e,t,o,i,a,r,n,l,s,d,c,u,v,_,h,p,y,m,f,g,b,w,x,$,k,E,C,z,S,M,A,P,D,T,O,j,N,G,B,F,R,H,L,W,V,Z,K,Y,q,J,Q,X,ee,te,oe,ie,ae,re,ne,le,se,de,ce,ue,ve,_e,he,pe,ye,fe,we,xe,$e,ke,Ee,Ce,ze,Se,Me,Ae,Pe,De,Te,Oe,je,Ne,Ge,Be,Fe,Re,He,Le,Ie,Ue,We,Ve,Ze,Ke,Ye,qe,Je,Qe,Xe,et,tt,ot,it,at,rt,nt,dt,ct,ut,vt,_t,ht,pt,yt,mt,ft,gt,bt,wt,xt,$t,kt,Et,Ct,zt,St,Mt,At,Pt,Dt,Tt,Ot,jt,Nt,Gt,Bt,Ft,Rt,Ht,Lt,It,Ut,Wt,Vt,Zt,Kt,Yt,qt,Jt,Qt,Xt,eo,to,oo,io,ao,ro,no,lo,so,co,uo,vo,_o,ho,po,yo,mo,fo,go,bo,wo,xo,$o,ko,Eo,Co,zo,So,Mo,Ao,Po,Do,To,Oo,jo,No,Go,Bo,Fo,Ro,Ho,Lo,Io,Uo,Wo,Vo,Zo,Ko,Yo,qo,Jo,Qo,Xo,ei,ti,oi,ii,ai,ri,ni,li,si,di,ci,ui,vi,_i,hi,pi,yi,mi,fi,gi,bi,wi,xi,$i,ki,Ei,Ci,zi,Si,Mi,Ai,Pi,Di,Ti,Oi,ji,Ni,Gi,Bi,Fi,Ri,Hi,Li,Ii,Ui,Wi,Vi,Zi,Ki,Yi,qi,Ji,Qi;if(!this._config||!this.hass)return I``;const{entities:Xi}=this._config;this.style.setProperty("--clickable-cursor",this._config.clickable_entities?"pointer":"default");const ea=null,ta=null,oa={entity:null===(e=Xi.grid)||void 0===e?void 0:e.entity,has:void 0!==(null===(t=null==Xi?void 0:Xi.grid)||void 0===t?void 0:t.entity),hasReturnToGrid:"string"==typeof(null===(o=Xi.grid)||void 0===o?void 0:o.entity)||(null===(a=null===(i=Xi.grid)||void 0===i?void 0:i.entity)||void 0===a?void 0:a.production),state:{fromGrid:0,toGrid:ea,toBattery:ea,toHome:ea},powerOutage:{has:this.hasField(null===(r=Xi.grid)||void 0===r?void 0:r.power_outage,!0),isOutage:(Xi.grid&&(null===(l=this.hass.states[null===(n=Xi.grid.power_outage)||void 0===n?void 0:n.entity])||void 0===l?void 0:l.state))===(null!==(c=null===(d=null===(s=Xi.grid)||void 0===s?void 0:s.power_outage)||void 0===d?void 0:d.state_alert)&&void 0!==c?c:"on"),icon:(null===(v=null===(u=Xi.grid)||void 0===u?void 0:u.power_outage)||void 0===v?void 0:v.icon_alert)||"mdi:transmission-tower-off",name:null!==(p=null===(h=null===(_=Xi.grid)||void 0===_?void 0:_.power_outage)||void 0===h?void 0:h.label_alert)&&void 0!==p?p:I`Power<br>Outage`},icon:this.computeFieldIcon(Xi.grid,"mdi:transmission-tower"),name:this.computeFieldName(Xi.grid,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.grid")),mainEntity:"object"==typeof(null===(y=Xi.grid)||void 0===y?void 0:y.entity)?Xi.grid.entity.consumption||Xi.grid.entity.production:null===(m=Xi.grid)||void 0===m?void 0:m.entity,color:{fromGrid:null===(g=null===(f=Xi.grid)||void 0===f?void 0:f.color)||void 0===g?void 0:g.consumption,toGrid:null===(w=null===(b=Xi.grid)||void 0===b?void 0:b.color)||void 0===w?void 0:w.production,icon_type:null===(x=Xi.grid)||void 0===x?void 0:x.color_icon,circle_type:null===($=Xi.grid)||void 0===$?void 0:$.color_circle},secondary:{entity:null===(E=null===(k=Xi.grid)||void 0===k?void 0:k.secondary_info)||void 0===E?void 0:E.entity,template:null===(z=null===(C=Xi.grid)||void 0===C?void 0:C.secondary_info)||void 0===z?void 0:z.template,has:this.hasField(null===(S=Xi.grid)||void 0===S?void 0:S.secondary_info,!0),state:ta,icon:null===(A=null===(M=Xi.grid)||void 0===M?void 0:M.secondary_info)||void 0===A?void 0:A.icon,unit:null===(D=null===(P=Xi.grid)||void 0===P?void 0:P.secondary_info)||void 0===D?void 0:D.unit_of_measurement,unit_white_space:null===(O=null===(T=Xi.grid)||void 0===T?void 0:T.secondary_info)||void 0===O?void 0:O.unit_white_space,color:{type:null===(N=null===(j=Xi.grid)||void 0===j?void 0:j.secondary_info)||void 0===N?void 0:N.color_value}}},ia={entity:null===(G=Xi.solar)||void 0===G?void 0:G.entity,has:void 0!==(null===(B=Xi.solar)||void 0===B?void 0:B.entity),state:{total:ea,toHome:ea,toGrid:ea,toBattery:ea},icon:this.computeFieldIcon(Xi.solar,"mdi:solar-power"),name:this.computeFieldName(Xi.solar,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.solar")),secondary:{entity:null===(R=null===(F=Xi.solar)||void 0===F?void 0:F.secondary_info)||void 0===R?void 0:R.entity,template:null===(L=null===(H=Xi.solar)||void 0===H?void 0:H.secondary_info)||void 0===L?void 0:L.template,has:this.hasField(null===(W=Xi.solar)||void 0===W?void 0:W.secondary_info,!0),state:ta,icon:null===(Z=null===(V=Xi.solar)||void 0===V?void 0:V.secondary_info)||void 0===Z?void 0:Z.icon,unit:null===(Y=null===(K=Xi.solar)||void 0===K?void 0:K.secondary_info)||void 0===Y?void 0:Y.unit_of_measurement,unit_white_space:null===(J=null===(q=Xi.solar)||void 0===q?void 0:q.secondary_info)||void 0===J?void 0:J.unit_white_space}},aa={entity:null===(Q=Xi.battery)||void 0===Q?void 0:Q.entity,has:void 0!==(null===(X=null==Xi?void 0:Xi.battery)||void 0===X?void 0:X.entity),mainEntity:"object"==typeof(null===(ee=Xi.battery)||void 0===ee?void 0:ee.entity)?Xi.battery.entity.consumption:null===(te=Xi.battery)||void 0===te?void 0:te.entity,name:this.computeFieldName(Xi.battery,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.battery")),icon:this.computeFieldIcon(Xi.battery,"mdi:battery-high"),state_of_charge:{state:(null===(ie=null===(oe=Xi.battery)||void 0===oe?void 0:oe.state_of_charge)||void 0===ie?void 0:ie.length)?this.getEntityState(null===(ae=Xi.battery)||void 0===ae?void 0:ae.state_of_charge):null,unit:(null===(re=null==Xi?void 0:Xi.battery)||void 0===re?void 0:re.state_of_charge_unit)||"%",unit_white_space:(null===(ne=null==Xi?void 0:Xi.battery)||void 0===ne?void 0:ne.state_of_charge_unit_white_space)||!0,decimals:(null===(le=null==Xi?void 0:Xi.battery)||void 0===le?void 0:le.state_of_charge_decimals)||0},state:{toBattery:0,fromBattery:0,toGrid:0,toHome:0},color:{fromBattery:null===(de=null===(se=Xi.battery)||void 0===se?void 0:se.color)||void 0===de?void 0:de.consumption,toBattery:null===(ue=null===(ce=Xi.battery)||void 0===ce?void 0:ce.color)||void 0===ue?void 0:ue.production,icon_type:void 0,circle_type:null===(ve=Xi.battery)||void 0===ve?void 0:ve.color_circle}},ra={entity:null===(_e=Xi.home)||void 0===_e?void 0:_e.entity,has:void 0!==(null===(he=null==Xi?void 0:Xi.home)||void 0===he?void 0:he.entity),state:ea,icon:this.computeFieldIcon(null==Xi?void 0:Xi.home,"mdi:home"),name:this.computeFieldName(null==Xi?void 0:Xi.home,this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.home")),color:{icon_type:null===(pe=Xi.home)||void 0===pe?void 0:pe.color_icon},secondary:{entity:null===(fe=null===(ye=Xi.home)||void 0===ye?void 0:ye.secondary_info)||void 0===fe?void 0:fe.entity,template:null===(xe=null===(we=Xi.home)||void 0===we?void 0:we.secondary_info)||void 0===xe?void 0:xe.template,has:this.hasField(null===($e=Xi.home)||void 0===$e?void 0:$e.secondary_info,!0),state:null,unit:null===(Ee=null===(ke=Xi.home)||void 0===ke?void 0:ke.secondary_info)||void 0===Ee?void 0:Ee.unit_of_measurement,unit_white_space:null===(ze=null===(Ce=Xi.home)||void 0===Ce?void 0:Ce.secondary_info)||void 0===ze?void 0:ze.unit_white_space,icon:null===(Me=null===(Se=Xi.home)||void 0===Se?void 0:Se.secondary_info)||void 0===Me?void 0:Me.icon,decimals:null===(Pe=null===(Ae=Xi.home)||void 0===Ae?void 0:Ae.secondary_info)||void 0===Pe?void 0:Pe.decimals}},na=e=>{var t,o,i,a,r,n,l,s,d,c,u,v,_,h,p,y,m,f,g,b,w,x,$,k;return{entity:null===(t=Xi[e])||void 0===t?void 0:t.entity,has:this.hasField(Xi[e]),displayZero:null===(o=Xi[e])||void 0===o?void 0:o.display_zero,displayZeroTolerance:null===(i=Xi[e])||void 0===i?void 0:i.display_zero_tolerance,state:ea,icon:this.computeFieldIcon(Xi[e],"individual1"===e?"mdi:car-electric":"mdi:motorbike-electric"),name:this.computeFieldName(Xi[e],lt("individual1"===e?"card.label.car":"card.label.motorbike")),color:null===(a=Xi[e])||void 0===a?void 0:a.color,unit:null===(r=Xi[e])||void 0===r?void 0:r.unit_of_measurement,unit_white_space:null===(n=Xi[e])||void 0===n?void 0:n.unit_white_space,decimals:null===(l=Xi[e])||void 0===l?void 0:l.decimals,invertAnimation:(null===(s=Xi[e])||void 0===s?void 0:s.inverted_animation)||!1,showDirection:(null===(d=Xi[e])||void 0===d?void 0:d.show_direction)||!1,secondary:{entity:null===(u=null===(c=Xi[e])||void 0===c?void 0:c.secondary_info)||void 0===u?void 0:u.entity,template:null===(_=null===(v=Xi[e])||void 0===v?void 0:v.secondary_info)||void 0===_?void 0:_.template,has:this.hasField(null===(h=Xi[e])||void 0===h?void 0:h.secondary_info,!0),state:ta,icon:null===(y=null===(p=Xi[e])||void 0===p?void 0:p.secondary_info)||void 0===y?void 0:y.icon,unit:null===(f=null===(m=Xi[e])||void 0===m?void 0:m.secondary_info)||void 0===f?void 0:f.unit_of_measurement,unit_white_space:null===(b=null===(g=Xi[e])||void 0===g?void 0:g.secondary_info)||void 0===b?void 0:b.unit_white_space,displayZero:null===(x=null===(w=Xi[e])||void 0===w?void 0:w.secondary_info)||void 0===x?void 0:x.display_zero,displayZeroTolerance:null===(k=null===($=Xi[e])||void 0===$?void 0:$.secondary_info)||void 0===k?void 0:k.display_zero_tolerance}}},la=na("individual1"),sa=na("individual2"),da={entity:null===(De=Xi.fossil_fuel_percentage)||void 0===De?void 0:De.entity,name:(null===(Te=Xi.fossil_fuel_percentage)||void 0===Te?void 0:Te.name)||(null===(Oe=Xi.fossil_fuel_percentage)||void 0===Oe?void 0:Oe.use_metadata)&&(null===(je=this.getEntityStateObj(Xi.fossil_fuel_percentage.entity))||void 0===je?void 0:je.attributes.friendly_name)||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.low_carbon"),icon:(null===(Ne=Xi.fossil_fuel_percentage)||void 0===Ne?void 0:Ne.icon)||(null===(Ge=Xi.fossil_fuel_percentage)||void 0===Ge?void 0:Ge.use_metadata)&&(null===(Fe=null===(Be=this.getEntityStateObj(Xi.fossil_fuel_percentage.entity))||void 0===Be?void 0:Be.attributes)||void 0===Fe?void 0:Fe.icon)||"mdi:leaf",has:!1,hasPercentage:!1,state:{power:ea},color:null===(Re=Xi.fossil_fuel_percentage)||void 0===Re?void 0:Re.color,color_value:null===(He=Xi.fossil_fuel_percentage)||void 0===He?void 0:He.color_value,secondary:{entity:null===(Ie=null===(Le=Xi.fossil_fuel_percentage)||void 0===Le?void 0:Le.secondary_info)||void 0===Ie?void 0:Ie.entity,template:null===(We=null===(Ue=Xi.fossil_fuel_percentage)||void 0===Ue?void 0:Ue.secondary_info)||void 0===We?void 0:We.template,has:this.hasField(null===(Ve=Xi.fossil_fuel_percentage)||void 0===Ve?void 0:Ve.secondary_info,!0),state:ta,icon:null===(Ke=null===(Ze=Xi.fossil_fuel_percentage)||void 0===Ze?void 0:Ze.secondary_info)||void 0===Ke?void 0:Ke.icon,unit:null===(qe=null===(Ye=Xi.fossil_fuel_percentage)||void 0===Ye?void 0:Ye.secondary_info)||void 0===qe?void 0:qe.unit_of_measurement,unit_white_space:null===(Qe=null===(Je=Xi.fossil_fuel_percentage)||void 0===Je?void 0:Je.secondary_info)||void 0===Qe?void 0:Qe.unit_white_space,color_value:null===(et=null===(Xe=Xi.fossil_fuel_percentage)||void 0===Xe?void 0:Xe.secondary_info)||void 0===et?void 0:et.color_value}};if(oa.powerOutage.isOutage&&(oa.state.fromGrid=0,oa.state.toGrid=0,oa.icon=oa.powerOutage.icon),oa.has&&("string"==typeof Xi.grid.entity?this.entityInverted("grid")?oa.state.fromGrid=Math.abs(Math.min(this.getEntityStateWatts(null===(tt=Xi.grid)||void 0===tt?void 0:tt.entity),0)):oa.state.fromGrid=Math.max(this.getEntityStateWatts(null===(ot=Xi.grid)||void 0===ot?void 0:ot.entity),0):oa.state.fromGrid=this.getEntityStateWatts(Xi.grid.entity.consumption)),oa.hasReturnToGrid&&("string"==typeof Xi.grid.entity?oa.state.toGrid=this.entityInverted("grid")?Math.max(this.getEntityStateWatts(Xi.grid.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Xi.grid.entity),0)):oa.state.toGrid=this.getEntityStateWatts(null===(it=Xi.grid)||void 0===it?void 0:it.entity.production)),this.style.setProperty("--secondary-text-solar-color",(null===(rt=null===(at=Xi.solar)||void 0===at?void 0:at.secondary_info)||void 0===rt?void 0:rt.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),ia.secondary.has){const e=this.hass.states[null===(dt=null===(nt=Xi.solar)||void 0===nt?void 0:nt.secondary_info)||void 0===dt?void 0:dt.entity].state;Number.isNaN(+e)?ia.secondary.state=e:ia.secondary.state=Math.max(Number(e),0)}if(void 0!==(null===(ct=Xi.solar)||void 0===ct?void 0:ct.color)){let e=null===(ut=Xi.solar)||void 0===ut?void 0:ut.color;"object"==typeof e&&(e=this.convertColorListToHex(e)),this.style.setProperty("--energy-solar-color",e||"#ff9800")}if(this.style.setProperty("--icon-solar-color",(null===(vt=Xi.solar)||void 0===vt?void 0:vt.color_icon)?"var(--energy-solar-color)":"var(--primary-text-color)"),ia.has&&(this.entityInverted("solar")?ia.state.total=Math.abs(Math.min(this.getEntityStateWatts(null===(_t=Xi.solar)||void 0===_t?void 0:_t.entity),0)):ia.state.total=Math.max(this.getEntityStateWatts(null===(ht=Xi.solar)||void 0===ht?void 0:ht.entity),0),(null===(pt=Xi.solar)||void 0===pt?void 0:pt.display_zero_tolerance)&&Xi.solar.display_zero_tolerance>=ia.state.total&&(ia.state.total=0)),aa.has&&("string"==typeof(null===(yt=Xi.battery)||void 0===yt?void 0:yt.entity)?(aa.state.toBattery=this.entityInverted("battery")?Math.max(this.getEntityStateWatts(Xi.battery.entity),0):Math.abs(Math.min(this.getEntityStateWatts(Xi.battery.entity),0)),aa.state.fromBattery=this.entityInverted("battery")?Math.abs(Math.min(this.getEntityStateWatts(Xi.battery.entity),0)):Math.max(this.getEntityStateWatts(Xi.battery.entity),0)):(aa.state.toBattery=this.getEntityStateWatts(null===(ft=null===(mt=Xi.battery)||void 0===mt?void 0:mt.entity)||void 0===ft?void 0:ft.production),aa.state.fromBattery=this.getEntityStateWatts(null===(bt=null===(gt=Xi.battery)||void 0===gt?void 0:gt.entity)||void 0===bt?void 0:bt.consumption)),(null===(wt=null==Xi?void 0:Xi.battery)||void 0===wt?void 0:wt.display_zero_tolerance)&&(Xi.battery.display_zero_tolerance>=aa.state.toBattery&&(aa.state.toBattery=0),Xi.battery.display_zero_tolerance>=aa.state.fromBattery&&(aa.state.fromBattery=0))),ia.has&&(ia.state.toHome=(null!==(xt=ia.state.total)&&void 0!==xt?xt:0)-(null!==($t=oa.state.toGrid)&&void 0!==$t?$t:0)-(null!==(kt=aa.state.toBattery)&&void 0!==kt?kt:0)),null!==ia.state.toHome&&ia.state.toHome<0&&(aa.has&&(oa.state.toBattery=Math.abs(ia.state.toHome),oa.state.toBattery>(null!==(Et=oa.state.fromGrid)&&void 0!==Et?Et:0)&&(aa.state.toGrid=Math.min(oa.state.toBattery-(null!==(Ct=oa.state.fromGrid)&&void 0!==Ct?Ct:0),0),oa.state.toBattery=oa.state.fromGrid)),ia.state.toHome=0),aa.has&&(ia.has?(aa.state.toGrid||(aa.state.toGrid=Math.max(0,(oa.state.toGrid||0)-(ia.state.total||0)-(aa.state.toBattery||0)-(oa.state.toBattery||0))),ia.state.toBattery=aa.state.toBattery-(oa.state.toBattery||0)):aa.state.toGrid=oa.state.toGrid||0,aa.state.toHome=(null!==(zt=aa.state.fromBattery)&&void 0!==zt?zt:0)-(null!==(St=aa.state.toGrid)&&void 0!==St?St:0)),oa.state.toHome=Math.max(oa.state.fromGrid-(null!==(Mt=oa.state.toBattery)&&void 0!==Mt?Mt:0),0),ia.has&&oa.state.toGrid&&(ia.state.toGrid=oa.state.toGrid-(null!==(At=aa.state.toGrid)&&void 0!==At?At:0)),this.style.setProperty("--text-solar-color",(null===(Pt=Xi.solar)||void 0===Pt?void 0:Pt.color_value)?"var(--energy-solar-color)":"var(--primary-text-color)"),void 0!==oa.color.fromGrid&&"object"==typeof oa.color.fromGrid&&(oa.color.fromGrid=this.convertColorListToHex(oa.color.fromGrid)),oa.secondary.has){const e=this.hass.states[null===(Tt=null===(Dt=Xi.grid)||void 0===Dt?void 0:Dt.secondary_info)||void 0===Tt?void 0:Tt.entity].state;Number.isNaN(+e)?oa.secondary.state=e:oa.secondary.state=Math.max(Number(e),0)}if(void 0!==oa.color.toGrid&&("object"==typeof oa.color.toGrid&&(oa.color.toGrid=this.convertColorListToHex(oa.color.toGrid)),this.style.setProperty("--energy-grid-return-color",oa.color.toGrid||"#a280db")),void 0!==oa.color.fromGrid&&("object"==typeof oa.color.fromGrid&&(oa.color.fromGrid=this.convertColorListToHex(oa.color.fromGrid)),this.style.setProperty("--energy-grid-consumption-color",oa.color.fromGrid||"#a280db")),void 0!==(null===(Ot=Xi.grid)||void 0===Ot?void 0:Ot.display_zero_tolerance)&&(ia.state.toGrid=(null!==(jt=ia.state.toGrid)&&void 0!==jt?jt:0)>(null===(Nt=Xi.grid)||void 0===Nt?void 0:Nt.display_zero_tolerance)?ia.state.toGrid:0,oa.state.toGrid=(null!==(Gt=oa.state.toGrid)&&void 0!==Gt?Gt:0)>(null===(Bt=Xi.grid)||void 0===Bt?void 0:Bt.display_zero_tolerance)?oa.state.toGrid:0,oa.state.fromGrid=oa.state.fromGrid>(null===(Ft=Xi.grid)||void 0===Ft?void 0:Ft.display_zero_tolerance)?oa.state.fromGrid:0),this.style.setProperty("--icon-grid-color","consumption"===oa.color.icon_type?"var(--energy-grid-consumption-color)":"production"===oa.color.icon_type?"var(--energy-grid-return-color)":!0===oa.color.icon_type?(null!==(Rt=oa.state.fromGrid)&&void 0!==Rt?Rt:0)>=(null!==(Ht=oa.state.toGrid)&&void 0!==Ht?Ht:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-grid-color","consumption"===oa.secondary.color.type?"var(--energy-grid-consumption-color)":"production"===oa.secondary.color.type?"var(--energy-grid-return-color)":!0===oa.secondary.color.type?(null!==(Lt=oa.state.fromGrid)&&void 0!==Lt?Lt:0)>=(null!==(It=oa.state.toGrid)&&void 0!==It?It:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-grid-color","consumption"===oa.color.circle_type?"var(--energy-grid-consumption-color)":"production"===oa.color.circle_type?"var(--energy-grid-return-color)":!0===oa.color.circle_type?(null!==(Ut=oa.state.fromGrid)&&void 0!==Ut?Ut:0)>=(null!==(Wt=oa.state.toGrid)&&void 0!==Wt?Wt:0)?"var(--energy-grid-consumption-color)":"var(--energy-grid-return-color)":"var(--energy-grid-consumption-color)"),void 0!==la.color&&("object"==typeof la.color&&(la.color=this.convertColorListToHex(la.color)),this.style.setProperty("--individualone-color",la.color)),this.style.setProperty("--icon-individualone-color",(null===(Vt=Xi.individual1)||void 0===Vt?void 0:Vt.color_icon)?"var(--individualone-color)":"var(--primary-text-color)"),la.has){const e=this.getEntityStateWatts(null===(Zt=Xi.individual1)||void 0===Zt?void 0:Zt.entity);e<0&&(la.invertAnimation=!la.invertAnimation),la.state=Math.abs(e)}if(la.secondary.has){const e=this.hass.states[null===(Yt=null===(Kt=Xi.individual1)||void 0===Kt?void 0:Kt.secondary_info)||void 0===Yt?void 0:Yt.entity].state;"number"==typeof e?la.secondary.state=Math.max(e,0):"string"==typeof e&&(la.secondary.state=e)}if(void 0!==da.entity&&(da.hasPercentage=void 0!==(null===(qt=Xi.fossil_fuel_percentage)||void 0===qt?void 0:qt.entity)&&!0===(null===(Jt=Xi.fossil_fuel_percentage)||void 0===Jt?void 0:Jt.display_zero)||1*(null!==(Qt=oa.state.fromGrid)&&void 0!==Qt?Qt:0)-this.getEntityState(null===(Xt=Xi.fossil_fuel_percentage)||void 0===Xt?void 0:Xt.entity)/100>0&&void 0!==(null===(eo=Xi.fossil_fuel_percentage)||void 0===eo?void 0:eo.entity)&&this.entityAvailable(null===(to=Xi.fossil_fuel_percentage)||void 0===to?void 0:to.entity)),void 0!==sa.color&&("object"==typeof sa.color&&(sa.color=this.convertColorListToHex(sa.color)),this.style.setProperty("--individualtwo-color",sa.color)),this.style.setProperty("--icon-individualtwo-color",(null===(oo=Xi.individual2)||void 0===oo?void 0:oo.color_icon)?"var(--individualtwo-color)":"var(--primary-text-color)"),sa.has){const e=this.getEntityStateWatts(null===(io=Xi.individual2)||void 0===io?void 0:io.entity);e<0&&(sa.invertAnimation=!sa.invertAnimation),sa.state=Math.abs(e)}if(sa.secondary.has){const e=this.hass.states[null===(ro=null===(ao=Xi.individual2)||void 0===ao?void 0:ao.secondary_info)||void 0===ro?void 0:ro.entity].state;"number"==typeof e?sa.secondary.state=Math.max(e,0):"string"==typeof e&&(sa.secondary.state=e)}if(ra.secondary.has){const e=this.hass.states[null===(lo=null===(no=Xi.home)||void 0===no?void 0:no.secondary_info)||void 0===lo?void 0:lo.entity].state;Number.isNaN(+e)?ra.secondary.state=e:ra.secondary.state=Math.max(Number(e),0)}void 0!==aa.color.fromBattery&&("object"==typeof aa.color.fromBattery&&(aa.color.fromBattery=this.convertColorListToHex(aa.color.fromBattery)),this.style.setProperty("--energy-battery-out-color",aa.color.fromBattery||"#4db6ac")),void 0!==aa.color.toBattery&&("object"==typeof aa.color.toBattery&&(aa.color.toBattery=this.convertColorListToHex(aa.color.toBattery)),this.style.setProperty("--energy-battery-in-color",aa.color.toBattery||"#a280db")),aa.color.icon_type=null===(so=Xi.battery)||void 0===so?void 0:so.color_icon,this.style.setProperty("--icon-battery-color","consumption"===aa.color.icon_type?"var(--energy-battery-in-color)":"production"===aa.color.icon_type?"var(--energy-battery-out-color)":!0===aa.color.icon_type?aa.state.fromBattery>=aa.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)");const ca=null===(co=Xi.battery)||void 0===co?void 0:co.color_state_of_charge_value;this.style.setProperty("--text-battery-state-of-charge-color","consumption"===ca?"var(--energy-battery-in-color)":"production"===ca?"var(--energy-battery-out-color)":!0===ca?aa.state.fromBattery>=aa.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)":"var(--primary-text-color)"),this.style.setProperty("--circle-battery-color","consumption"===aa.color.circle_type?"var(--energy-battery-in-color)":"production"===aa.color.circle_type||!0===aa.color.circle_type&&aa.state.fromBattery>=aa.state.toBattery?"var(--energy-battery-out-color)":"var(--energy-battery-in-color)");const ua=be(la.state,0)*(la.invertAnimation?-1:1)+be(sa.state,0)*(sa.invertAnimation?-1:1),va=Math.max(oa.state.toHome+(null!==(uo=ia.state.toHome)&&void 0!==uo?uo:0)+(null!==(vo=aa.state.toHome)&&void 0!==vo?vo:0),0);let _a=0;aa.state.toHome&&(_a=st*(aa.state.toHome/va));let ha=0;if(ia.has&&(ha=st*(ia.state.toHome/va)),da.secondary.has){const e=this.hass.states[null===(ho=null===(_o=Xi.fossil_fuel_percentage)||void 0===_o?void 0:_o.secondary_info)||void 0===ho?void 0:ho.entity].state;"number"==typeof e?da.secondary.state=Math.max(e,0):"string"==typeof e&&(da.secondary.state=e)}let pa=0;if(da.has=1*oa.state.toHome-this.getEntityState(null===(po=Xi.fossil_fuel_percentage)||void 0===po?void 0:po.entity)/100>0&&void 0!==(null===(yo=Xi.fossil_fuel_percentage)||void 0===yo?void 0:yo.entity)&&this.entityAvailable(null===(mo=Xi.fossil_fuel_percentage)||void 0===mo?void 0:mo.entity),da.has){const e=1-this.getEntityState(null===(fo=Xi.fossil_fuel_percentage)||void 0===fo?void 0:fo.entity)/100;da.state.power=oa.state.toHome*e,pa=st*(da.state.power/va)}da.hasPercentage=void 0!==(null===(go=Xi.fossil_fuel_percentage)||void 0===go?void 0:go.entity)&&!0===(null===(bo=Xi.fossil_fuel_percentage)||void 0===bo?void 0:bo.display_zero)||da.has;const ya=oa.state.toHome+(null!==(wo=ia.state.toHome)&&void 0!==wo?wo:0)+(null!==(xo=ia.state.toGrid)&&void 0!==xo?xo:0)+(null!==($o=ia.state.toBattery)&&void 0!==$o?$o:0)+(null!==(ko=aa.state.toHome)&&void 0!==ko?ko:0)+(null!==(Eo=oa.state.toBattery)&&void 0!==Eo?Eo:0)+(null!==(Co=aa.state.toGrid)&&void 0!==Co?Co:0);null===aa.state_of_charge.state?aa.icon="mdi:battery":aa.state_of_charge.state<=72&&aa.state_of_charge.state>44?aa.icon="mdi:battery-medium":aa.state_of_charge.state<=44&&aa.state_of_charge.state>16?aa.icon="mdi:battery-low":aa.state_of_charge.state<=16&&(aa.icon="mdi:battery-outline"),void 0!==(null===(zo=Xi.battery)||void 0===zo?void 0:zo.icon)&&(aa.icon=null===(So=Xi.battery)||void 0===So?void 0:So.icon);const ma={batteryGrid:this.circleRate(null!==(Ao=null!==(Mo=oa.state.toBattery)&&void 0!==Mo?Mo:aa.state.toGrid)&&void 0!==Ao?Ao:0,ya),batteryToHome:this.circleRate(null!==(Po=aa.state.toHome)&&void 0!==Po?Po:0,ya),gridToHome:this.circleRate(oa.state.toHome,ya),solarToBattery:this.circleRate(null!==(Do=ia.state.toBattery)&&void 0!==Do?Do:0,ya),solarToGrid:this.circleRate(null!==(To=ia.state.toGrid)&&void 0!==To?To:0,ya),solarToHome:this.circleRate(null!==(Oo=ia.state.toHome)&&void 0!==Oo?Oo:0,ya),individual1:this.circleRate(null!==(jo=la.state)&&void 0!==jo?jo:0,ua),individual2:this.circleRate(null!==(No=sa.state)&&void 0!==No?No:0,ua),nonFossil:this.circleRate(null!==(Go=da.state.power)&&void 0!==Go?Go:0,ya)};["batteryGrid","batteryToHome","gridToHome","solarToBattery","solarToGrid","solarToHome"].forEach((e=>{const t=this[`${e}Flow`];t&&this.previousDur[e]&&this.previousDur[e]!==ma[e]&&(t.pauseAnimations(),t.setCurrentTime(t.getCurrentTime()*(ma[e]/this.previousDur[e])),t.unpauseAnimations()),this.previousDur[e]=ma[e]})),void 0!==da.color&&("object"==typeof da.color&&(da.color=this.convertColorListToHex(da.color)),this.style.setProperty("--non-fossil-color",da.color||"var(--energy-non-fossil-color)")),this.style.setProperty("--icon-non-fossil-color",(null===(Bo=Xi.fossil_fuel_percentage)||void 0===Bo?void 0:Bo.color_icon)?"var(--non-fossil-color)":"var(--primary-text-color)");const fa=e=>void 0===e.state?"":this.displayValue(e.state,e.unit,e.unit_white_space,e.decimals),ga=fa(la),ba=fa(sa);if(this.style.setProperty("--text-non-fossil-color",(null===(Fo=Xi.fossil_fuel_percentage)||void 0===Fo?void 0:Fo.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-non-fossil-color",(null===(Ho=null===(Ro=Xi.fossil_fuel_percentage)||void 0===Ro?void 0:Ro.secondary_info)||void 0===Ho?void 0:Ho.color_value)?"var(--non-fossil-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualone-color",(null===(Lo=Xi.individual1)||void 0===Lo?void 0:Lo.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--text-individualtwo-color",(null===(Io=Xi.individual2)||void 0===Io?void 0:Io.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualone-color",(null===(Wo=null===(Uo=Xi.individual1)||void 0===Uo?void 0:Uo.secondary_info)||void 0===Wo?void 0:Wo.color_value)?"var(--individualone-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-individualtwo-color",(null===(Zo=null===(Vo=Xi.individual2)||void 0===Vo?void 0:Vo.secondary_info)||void 0===Zo?void 0:Zo.color_value)?"var(--individualtwo-color)":"var(--primary-text-color)"),this.style.setProperty("--secondary-text-home-color",(null===(Yo=null===(Ko=Xi.home)||void 0===Ko?void 0:Ko.secondary_info)||void 0===Yo?void 0:Yo.color_value)?"var(--text-home-color)":"var(--primary-text-color)"),this.style.setProperty("--transparency-unused-lines",(null===(Jo=null===(qo=this._config)||void 0===qo?void 0:qo.display_zero_lines)||void 0===Jo?void 0:Jo.transparency)?this._config.display_zero_lines.transparency.toString():"0"),void 0!==(null===(Qo=this._config.display_zero_lines)||void 0===Qo?void 0:Qo.grey_color)){let e=this._config.display_zero_lines.grey_color;"object"==typeof e&&(e=this.convertColorListToHex(e)),this.style.setProperty("--greyed-out--line-color",e)}const wa={gridSecondary:null===(Xo=this._templateResults.gridSecondary)||void 0===Xo?void 0:Xo.result,solarSecondary:null===(ei=this._templateResults.solarSecondary)||void 0===ei?void 0:ei.result,homeSecondary:null===(ti=this._templateResults.homeSecondary)||void 0===ti?void 0:ti.result,individual1Secondary:null===(oi=this._templateResults.individual1Secondary)||void 0===oi?void 0:oi.result,individual2Secondary:null===(ii=this._templateResults.individual2Secondary)||void 0===ii?void 0:ii.result,nonFossilFuelSecondary:null===(ai=this._templateResults.nonFossilFuelSecondary)||void 0===ai?void 0:ai.result},xa=(null===(ri=Xi.home)||void 0===ri?void 0:ri.override_state)&&Xi.home.entity?(null===(ni=Xi.home)||void 0===ni?void 0:ni.subtract_individual)?this.displayValue(this.getEntityStateWatts(Xi.home.entity)-ua):this.displayValue(this.getEntityStateWatts(Xi.home.entity)):(null===(li=Xi.home)||void 0===li?void 0:li.subtract_individual)?this.displayValue(va-ua||0):this.displayValue(va),$a=st*((va-(null!==(si=da.state.power)&&void 0!==si?si:0)-(null!==(di=aa.state.toHome)&&void 0!==di?di:0)-(null!==(ci=ia.state.toHome)&&void 0!==ci?ci:0))/va),ka={battery:{value:_a,color:"var(--energy-battery-out-color)"},solar:{value:ha,color:"var(--energy-solar-color)"},grid:{value:$a,color:"var(--energy-grid-consumption-color)"},gridNonFossil:{value:pa,color:"var(--energy-non-fossil-color)"}},Ea=this._width>420;ia.has&&(aa.has?(this.style.setProperty("--lines-svg-not-flat-line-height",Ea?"106%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",Ea?"-3%":"-1%"),this.style.setProperty("--lines-svg-flat-width","calc(100% - 160px)")):(this.style.setProperty("--lines-svg-not-flat-line-height",Ea?"104%":"102%"),this.style.setProperty("--lines-svg-not-flat-line-top",Ea?"-2%":"-1%"),this.style.setProperty("--lines-svg-flat-width",Ea?"calc(100% - 154px)":"calc(100% - 157px)"),this.style.setProperty("--lines-svg-not-flat-width",Ea?"calc(103% - 172px)":"calc(103% - 169px)")));const Ca=Object.keys(ka).reduce(((e,t)=>ka[e].value>ka[t].value?e:t));let za="var(--primary-text-color)";"solar"===ra.color.icon_type?za="var(--energy-solar-color)":"battery"===ra.color.icon_type?za="var(--energy-battery-out-color)":"grid"===ra.color.icon_type?za="var(--energy-grid-consumption-color)":!0===ra.color.icon_type&&(za=ka[Ca].color),this.style.setProperty("--icon-home-color",za);const Sa=null===(ui=Xi.home)||void 0===ui?void 0:ui.color_value;let Ma="var(--primary-text-color)";"solar"===Sa?Ma="var(--energy-solar-color)":"battery"===Sa?Ma="var(--energy-battery-out-color)":"grid"===Sa?Ma="var(--energy-grid-consumption-color)":!0===Sa&&(Ma=ka[Ca].color),this.style.setProperty("--text-home-color",Ma);const Aa=({className:e,template:t,value:o,entityId:i,icon:a})=>{var r,n;return o||t?I`<span class="secondary-info ${e}" @click="${e=>{this.openDetails(e,i)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,i)}}">${(null===(n=null===(r=Xi.solar)||void 0===r?void 0:r.secondary_info)||void 0===n?void 0:n.icon)?I`<ha-icon class="secondary-info small" .icon="${a}"></ha-icon>`:""} ${null!=t?t:o}</span>`:""},Pa=(e,t)=>I`${e.secondary.has||e.secondary.template?I`${Aa({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space),template:wa[`${t}Secondary`]})}`:""}`,Da=(e,t)=>{var o,i;const a=wa[`${t}Secondary`],r=e.secondary.has?this.displayValue(e.secondary.state,e.secondary.unit,e.secondary.unit_white_space):void 0,n=!1!==e.secondary.displayZero||!ge(e.secondary.state)||(null!==(o=Number(e.secondary.state))&&void 0!==o?o:0)>(null!==(i=e.secondary.displayZeroTolerance)&&void 0!==i?i:0);return I`${e.secondary.has&&n||a?I`${Aa({className:t,entityId:e.secondary.entity,icon:e.secondary.icon,value:r,template:wa[`${t}Secondary`]})}`:""}`};return I`<ha-card .header="${this._config.title}" class="${this._config.full_size?"full-size":""}" style="${this._config.style_ha_card?this._config.style_ha_card:""}"><div class="card-content ${this._config.full_size?"full-size":""}" id="power-flow-card-plus" style="${this._config.style_card_content?this._config.style_card_content:""}">${ia.has||sa.has||la.has||da.hasPercentage?I`<div class="row">${da.hasPercentage?I`<div class="circle-container low-carbon"><span class="label">${da.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.fossil_fuel_percentage)||void 0===t?void 0:t.entity)}}">${Pa(da,"nonFossilFuel")}<ha-icon .icon="${da.icon}" class="low-carbon" style="${da.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(vi=Xi.fossil_fuel_percentage)||void 0===vi?void 0:vi.display_zero_state)||(da.state.power||0)>((null===(_i=Xi.fossil_fuel_percentage)||void 0===_i?void 0:_i.display_zero_tolerance)||0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(hi=Xi.fossil_fuel_percentage)||void 0===hi?void 0:hi.display_zero_state)||(da.state.power||0)>((null===(pi=Xi.fossil_fuel_percentage)||void 0===pi?void 0:pi.display_zero_tolerance)||0)?I`<span class="low-carbon">${this.displayNonFossilState(Xi.fossil_fuel_percentage.entity,oa.state.fromGrid)}</span>`:""}</div>${this.showLine(da.state.power||0)?I`<svg width="80" height="30"><path d="M40 -10 v40" class="low-carbon ${this.styleLine(da.state.power||0)}" id="low-carbon"/>${da.has?U`<circle r="2.4" class="low-carbon" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(yi=Xi.fossil_fuel_percentage)||void 0===yi?void 0:yi.calculate_flow_rate,ma.nonFossil)}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#low-carbon"></animateMotion></circle>`:""}</svg>`:""}</div>`:I`<div class="spacer"></div>`} ${ia.has?I`<div class="circle-container solar"><span class="label">${ia.name}</span><div class="circle" @click="${e=>{this.openDetails(e,ia.entity)}}" @keyDown="${e=>{"Enter"===e.key&&this.openDetails(e,ia.entity)}}">${Pa(ia,"solar")}<ha-icon id="solar-icon" .icon="${ia.icon}" style="${ia.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(mi=Xi.solar)||void 0===mi?void 0:mi.display_zero_state)||(ia.state.total||0)>0?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(fi=Xi.solar)||void 0===fi?void 0:fi.display_zero_state)||(ia.state.total||0)>0?I`<span class="solar">${this.displayValue(ia.state.total)}</span>`:""}</div></div>`:sa.has||la.has?I`<div class="spacer"></div>`:""} ${sa.has?I`<div class="circle-container individual2"><span class="label">${sa.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.individual2)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.individual2)||void 0===t?void 0:t.entity)}}">${Da(sa,"individual2")}<ha-icon id="individual2-icon" .icon="${sa.icon}" style="${sa.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(gi=Xi.individual2)||void 0===gi?void 0:gi.display_zero_state)||(sa.state||0)>(null!==(bi=sa.displayZeroTolerance)&&void 0!==bi?bi:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(wi=Xi.individual2)||void 0===wi?void 0:wi.display_zero_state)||(sa.state||0)>(null!==(xi=sa.displayZeroTolerance)&&void 0!==xi?xi:0)?I`<span class="individual2">${sa.showDirection?I`<ha-icon class="small" .icon="${sa.invertAnimation?"mdi:arrow-down":"mdi:arrow-up"}"></ha-icon>`:""}${ba}</span>`:""}</div>${this.showLine(sa.state||0)?I`<svg width="80" height="30"><path d="M40 -10 v50" id="individual2" class="${this.styleLine(sa.state||0)}"/>${sa.state?U`<circle r="2.4" class="individual2" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===($i=Xi.individual2)||void 0===$i?void 0:$i.calculate_flow_rate,ma.individual2)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${sa.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual2"></animateMotion></circle>`:""}</svg>`:""}</div>`:la.has?I`<div class="circle-container individual1"><span class="label">${la.name}</span><div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.individual1)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.individual1)||void 0===t?void 0:t.entity)}}">${Da(la,"individual1")}<ha-icon id="individual1-icon" .icon="${la.icon}" style="${la.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(ki=Xi.individual1)||void 0===ki?void 0:ki.display_zero_state)||(la.state||0)>(null!==(Ei=la.displayZeroTolerance)&&void 0!==Ei?Ei:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Ci=Xi.individual1)||void 0===Ci?void 0:Ci.display_zero_state)||(la.state||0)>(null!==(zi=la.displayZeroTolerance)&&void 0!==zi?zi:0)?I`<span class="individual1">${la.showDirection?I`<ha-icon class="small" .icon="${la.invertAnimation?"mdi:arrow-down":"mdi:arrow-up"}"></ha-icon>`:""}${ga}</span>`:""}</div>${this.showLine(la.state||0)?I`<svg width="80" height="30"><path d="M40 -10 v40" id="individual1" class="${this.styleLine(la.state||0)}"/>${la.state?U`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Si=Xi.individual1)||void 0===Si?void 0:Si.calculate_flow_rate,ma.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${la.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:I``}</div>`:I`<div class="spacer"></div>`}</div>`:I``}<div class="row">${oa.has?I`<div class="circle-container grid"><div class="circle" @click="${e=>{const t="string"==typeof Xi.grid.entity?Xi.grid.entity:Xi.grid.entity.consumption||Xi.grid.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Xi.grid.entity?Xi.grid.entity:Xi.grid.entity.consumption||Xi.grid.entity.production;this.openDetails(e,t)}}}">${Pa(oa,"grid")}<ha-icon .icon="${oa.icon}"></ha-icon>${("two_way"===(null===(Mi=Xi.grid)||void 0===Mi?void 0:Mi.display_state)||void 0===(null===(Ai=Xi.grid)||void 0===Ai?void 0:Ai.display_state)||"one_way"===(null===(Pi=Xi.grid)||void 0===Pi?void 0:Pi.display_state)&&(null!==(Di=oa.state.toGrid)&&void 0!==Di?Di:0)>0||"one_way_no_zero"===(null===(Ti=Xi.grid)||void 0===Ti?void 0:Ti.display_state)&&(null===oa.state.fromGrid||0===oa.state.fromGrid)&&0!==oa.state.toGrid)&&null!==oa.state.toGrid&&!oa.powerOutage.isOutage?I`<span class="return" @click="${e=>{const t="string"==typeof Xi.grid.entity?Xi.grid.entity:Xi.grid.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Xi.grid.entity?Xi.grid.entity:Xi.grid.entity.production;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-left"}"></ha-icon>${this.displayValue(oa.state.toGrid)}</span>`:null} ${("two_way"===(null===(Oi=Xi.grid)||void 0===Oi?void 0:Oi.display_state)||void 0===(null===(ji=Xi.grid)||void 0===ji?void 0:ji.display_state)||"one_way"===(null===(Ni=Xi.grid)||void 0===Ni?void 0:Ni.display_state)&&oa.state.fromGrid>0||"one_way_no_zero"===(null===(Gi=Xi.grid)||void 0===Gi?void 0:Gi.display_state)&&(null===oa.state.toGrid||0===oa.state.toGrid))&&null!==oa.state.fromGrid&&!oa.powerOutage.isOutage?I`<span class="consumption"><ha-icon class="small" .icon="${"mdi:arrow-right"}"></ha-icon>${this.displayValue(oa.state.fromGrid)}</span>`:""} ${oa.powerOutage.isOutage?I`<span class="grid power-outage">${oa.powerOutage.name}</span>`:""}</div><span class="label">${oa.name}</span></div>`:I`<div class="spacer"></div>`}<div class="circle-container home"><div class="circle" id="home-circle" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.home)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.home)||void 0===t?void 0:t.entity)}}">${Pa(ra,"home")}<ha-icon .icon="${ra.icon}"></ha-icon>${xa} <svg class="home-circle-sections">${void 0!==ha?U`<circle class="solar" cx="40" cy="40" r="38" stroke-dasharray="${ha} ${st-ha}" shape-rendering="geometricPrecision" stroke-dashoffset="-${st-ha}">`:""} ${_a?U`<circle class="battery" cx="40" cy="40" r="38" stroke-dasharray="${_a} ${st-_a}" stroke-dashoffset="-${st-_a-(ha||0)}" shape-rendering="geometricPrecision">`:""} ${void 0!==pa?U`<circle class="low-carbon" cx="40" cy="40" r="38" stroke-dasharray="${pa} ${st-pa}" stroke-dashoffset="-${st-pa-(_a||0)-(ha||0)}" shape-rendering="geometricPrecision">`:""}<circle class="grid" cx="40" cy="40" r="38" stroke-dasharray="${null!=$a?$a:st-ha-(_a||0)} ${void 0!==$a?st-$a:ha+(_a||0)}" stroke-dashoffset="0" shape-rendering="geometricPrecision"/></svg></div>${this.showLine(la.state||0)&&sa.has&&la.has?"":I`<span class="label">${ra.name}</span>`}</div></div>${aa.has||la.has&&sa.has?I`<div class="row"><div class="spacer"></div>${aa.has?I`<div class="circle-container battery"><div class="circle" @click="${e=>{var t,o,i,a,r;const n=(null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Xi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof(null===(i=Xi.battery)||void 0===i?void 0:i.entity)?null===(a=Xi.battery)||void 0===a?void 0:a.entity:null===(r=Xi.battery)||void 0===r?void 0:r.entity.production;this.openDetails(e,n)}}" @keyDown="${e=>{var t,o;if("Enter"===e.key){const i=(null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)?null===(o=Xi.battery)||void 0===o?void 0:o.state_of_charge:"string"==typeof Xi.battery.entity?Xi.battery.entity:Xi.battery.entity.production;this.openDetails(e,i)}}}">${null!==aa.state_of_charge.state?I`<span @click="${e=>{var t;this.openDetails(e,null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)}}" id="battery-state-of-charge-text">${this.displayValue(aa.state_of_charge.state,aa.state_of_charge.unit,aa.state_of_charge.unit_white_space,aa.state_of_charge.decimals)}</span>`:null}<ha-icon .icon="${aa.icon}" style="${"two_way"===(null===(Bi=Xi.battery)||void 0===Bi?void 0:Bi.display_state)?"padding-top: 0px; padding-bottom: 2px;":"one_way"===(null===(Fi=Xi.battery)||void 0===Fi?void 0:Fi.display_state)&&0===aa.state.toBattery&&0===aa.state.fromBattery?"padding-top: 2px; padding-bottom: 0px;":"padding-top: 2px; padding-bottom: 2px;"}" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.battery)||void 0===t?void 0:t.state_of_charge)}}"></ha-icon>${"two_way"===(null===(Ri=Xi.battery)||void 0===Ri?void 0:Ri.display_state)||void 0===(null===(Hi=Xi.battery)||void 0===Hi?void 0:Hi.display_state)||"one_way"===(null===(Li=Xi.battery)||void 0===Li?void 0:Li.display_state)&&aa.state.toBattery>0||"one_way_no_zero"===(null===(Ii=Xi.battery)||void 0===Ii?void 0:Ii.display_state)&&0!==aa.state.toBattery?I`<span class="battery-in" @click="${e=>{const t="string"==typeof Xi.battery.entity?Xi.battery.entity:Xi.battery.entity.production;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Xi.battery.entity?Xi.battery.entity:Xi.battery.entity.production;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-down"}"></ha-icon>${this.displayValue(aa.state.toBattery)}</span>`:""} ${"two_way"===(null===(Ui=Xi.battery)||void 0===Ui?void 0:Ui.display_state)||void 0===(null===(Wi=Xi.battery)||void 0===Wi?void 0:Wi.display_state)||"one_way"===(null===(Vi=Xi.battery)||void 0===Vi?void 0:Vi.display_state)&&aa.state.fromBattery>0||"one_way_no_zero"===(null===(Zi=Xi.battery)||void 0===Zi?void 0:Zi.display_state)&&(0===aa.state.toBattery||0!==aa.state.fromBattery)?I`<span class="battery-out" @click="${e=>{const t="string"==typeof Xi.battery.entity?Xi.battery.entity:Xi.battery.entity.consumption;this.openDetails(e,t)}}" @keyDown="${e=>{if("Enter"===e.key){const t="string"==typeof Xi.battery.entity?Xi.battery.entity:Xi.battery.entity.consumption;this.openDetails(e,t)}}}"><ha-icon class="small" .icon="${"mdi:arrow-up"}"></ha-icon>${this.displayValue(aa.state.fromBattery)}</span>`:""}</div><span class="label">${aa.name}</span></div>`:I`<div class="spacer"></div>`} ${sa.has&&la.has?I`<div class="circle-container individual1 bottom">${this.showLine(la.state||0)?I`<svg width="80" height="30"><path d="M40 40 v-40" id="individual1" class="${this.styleLine(la.state||0)}"/>${la.state?U`<circle r="2.4" class="individual1" vector-effect="non-scaling-stroke"><animateMotion dur="${this.additionalCircleRate(null===(Ki=Xi.individual1)||void 0===Ki?void 0:Ki.calculate_flow_rate,ma.individual1)}s" repeatCount="indefinite" calcMode="linear" keyPoints="${la.invertAnimation?"0;1":"1;0"}" keyTimes="0;1"><mpath xlink:href="#individual1"></animateMotion></circle>`:""}</svg>`:I`<svg width="80" height="30"></svg>`}<div class="circle" @click="${e=>{var t;this.openDetails(e,null===(t=Xi.individual1)||void 0===t?void 0:t.entity)}}" @keyDown="${e=>{var t;"Enter"===e.key&&this.openDetails(e,null===(t=Xi.individual1)||void 0===t?void 0:t.entity)}}">${Da(la,"individual1")}<ha-icon id="individual1-icon" .icon="${la.icon}" style="${la.secondary.has?"padding-top: 2px;":"padding-top: 0px;"}${!1!==(null===(Yi=Xi.individual1)||void 0===Yi?void 0:Yi.display_zero_state)||(la.state||0)>(null!==(qi=la.displayZeroTolerance)&&void 0!==qi?qi:0)?"padding-bottom: 2px;":"padding-bottom: 0px;"}"></ha-icon>${!1!==(null===(Ji=Xi.individual1)||void 0===Ji?void 0:Ji.display_zero_state)||(la.state||0)>(null!==(Qi=la.displayZeroTolerance)&&void 0!==Qi?Qi:0)?I`<span class="individual1">${la.showDirection?I`<ha-icon class="small" .icon="${la.invertAnimation?"mdi:arrow-up":"mdi:arrow-down"}"></ha-icon>`:""}${ga}</span>`:""}</div><span class="label">${la.name}</span></div>`:I`<div class="spacer"></div>`}</div>`:I`<div class="spacer"></div>`} ${ia.has&&this.showLine(ia.state.toHome||0)?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-home-flow"><path id="solar" class="solar ${this.styleLine(ia.state.toHome||0)}" d="M${aa.has?55:53},0 v${oa.has?15:17} c0,${aa.has?"30 10,30 30,30":"35 10,35 30,35"} h25" vector-effect="non-scaling-stroke"></path>${ia.state.toHome?U`<circle r="1" class="solar" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.solarToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#solar"></animateMotion></circle>`:""}</svg></div>`:""} ${oa.hasReturnToGrid&&ia.has&&this.showLine(ia.state.toGrid||0)?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-grid-flow"><path id="return" class="return ${this.styleLine(ia.state.toGrid||0)}" d="M${aa.has?45:47},0 v15 c0,${aa.has?"30 -10,30 -30,30":"35 -10,35 -30,35"} h-20" vector-effect="non-scaling-stroke"></path>${ia.state.toGrid&&ia.has?U`<circle r="1" class="return" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.solarToGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#return"></animateMotion></circle>`:""}</svg></div>`:""} ${aa.has&&ia.has&&this.showLine(ia.state.toBattery||0)?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="solar-battery-flow" class="flat-line"><path id="battery-solar" class="battery-solar ${this.styleLine(ia.state.toBattery||0)}" d="M50,0 V100" vector-effect="non-scaling-stroke"></path>${ia.state.toBattery?U`<circle r="1" class="battery-solar" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.solarToBattery}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-solar"></animateMotion></circle>`:""}</svg></div>`:""} ${oa.has&&this.showLine(oa.state.fromGrid)?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="grid-home-flow" class="flat-line"><path class="grid ${this.styleLine(oa.state.toHome||0)}" id="grid" d="M0,${aa.has?50:ia.has?56:53} H100" vector-effect="non-scaling-stroke"></path>${oa.state.toHome?U`<circle r="1" class="grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.gridToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#grid"></animateMotion></circle>`:""}</svg></div>`:null} ${aa.has&&this.showLine(aa.state.toHome)?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-home-flow"><path id="battery-home" class="battery-home ${this.styleLine(aa.state.toHome||0)}" d="M55,100 v-${oa.has?15:17} c0,-30 10,-30 30,-30 h20" vector-effect="non-scaling-stroke"></path>${aa.state.toHome?U`<circle r="1" class="battery-home" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.batteryToHome}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-home"></animateMotion></circle>`:""}</svg></div>`:""} ${oa.has&&aa.has&&this.showLine(Math.max(oa.state.toBattery||0,aa.state.toGrid||0))?I`<div class="lines ${me({high:aa.has,"individual1-individual2":!aa.has&&sa.has&&la.has})}"><svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" id="battery-grid-flow"><path id="battery-grid" class="${this.styleLine(aa.state.toGrid||0)}" d="M45,100 v-15 c0,-30 -10,-30 -30,-30 h-20" vector-effect="non-scaling-stroke"></path>${oa.state.toBattery?U`<circle r="1" class="battery-from-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.batteryGrid}s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""} ${aa.state.toGrid?U`<circle r="1" class="battery-to-grid" vector-effect="non-scaling-stroke"><animateMotion dur="${ma.batteryGrid}s" repeatCount="indefinite" calcMode="linear"><mpath xlink:href="#battery-grid"></animateMotion></circle>`:""}</svg></div>`:""}</div>${this._config.dashboard_link?I`<div class="card-actions"><a href="${this._config.dashboard_link}"><mwc-button>${this._config.dashboard_link_label||this.hass.localize("ui.panel.lovelace.cards.energy.energy_distribution.go_to_energy_dashboard")}</mwc-button></a></div>`:""}</ha-card>`}updated(e){var t;if(super.updated(e),!this._config||!this.hass)return;const o=null===(t=null==this?void 0:this.shadowRoot)||void 0===t?void 0:t.querySelector("#power-flow-card-plus"),i=o?getComputedStyle(o).getPropertyValue("width"):"0px";this._width=parseInt(i.replace("px",""),10),this._tryConnectAll()}_tryConnectAll(){var e,t,o,i,a,r,n,l,s,d,c,u;const{entities:v}=this._config,_={gridSecondary:null===(t=null===(e=v.grid)||void 0===e?void 0:e.secondary_info)||void 0===t?void 0:t.template,solarSecondary:null===(i=null===(o=v.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(r=null===(a=v.home)||void 0===a?void 0:a.secondary_info)||void 0===r?void 0:r.template,individual1Secondary:null===(l=null===(n=v.individual1)||void 0===n?void 0:n.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=v.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template,nonFossilFuelSecondary:null===(u=null===(c=v.fossil_fuel_percentage)||void 0===c?void 0:c.secondary_info)||void 0===u?void 0:u.template};for(const[e,t]of Object.entries(_))t&&this._tryConnect(t,e)}async _tryConnect(e,t){var o,i,a,r,n,l;if(this.hass&&this._config&&void 0===(null===(o=this._unsubRenderTemplates)||void 0===o?void 0:o.get(t))&&""!==e)try{const o=(r=this.hass.connection,n=e=>{this._templateResults[t]=e},l={template:e,entity_ids:this._config.entity_id,variables:{config:this._config,user:this.hass.user.name},strict:!0},r.subscribeMessage((e=>n(e)),Object.assign({type:"render_template"},l)));null===(i=this._unsubRenderTemplates)||void 0===i||i.set(t,o),await o}catch(o){this._templateResults=Object.assign(Object.assign({},this._templateResults),{[t]:{result:e,listeners:{all:!1,domains:[],entities:[],time:!1}}}),null===(a=this._unsubRenderTemplates)||void 0===a||a.delete(t)}}async _tryDisconnectAll(){var e,t,o,i,a,r,n,l,s,d;const{entities:c}=this._config,u={gridSecondary:null===(t=null===(e=c.grid)||void 0===e?void 0:e.secondary_info)||void 0===t?void 0:t.template,solarSecondary:null===(i=null===(o=c.solar)||void 0===o?void 0:o.secondary_info)||void 0===i?void 0:i.template,homeSecondary:null===(r=null===(a=c.home)||void 0===a?void 0:a.secondary_info)||void 0===r?void 0:r.template,individual1Secondary:null===(l=null===(n=c.individual1)||void 0===n?void 0:n.secondary_info)||void 0===l?void 0:l.template,individual2Secondary:null===(d=null===(s=c.individual2)||void 0===s?void 0:s.secondary_info)||void 0===d?void 0:d.template};for(const[e,t]of Object.entries(u))t&&this._tryDisconnect(e)}async _tryDisconnect(e){var t,o;const i=null===(t=this._unsubRenderTemplates)||void 0===t?void 0:t.get(e);if(i)try{(await i)(),null===(o=this._unsubRenderTemplates)||void 0===o||o.delete(e)}catch(e){if("not_found"!==e.code&&"template_error"!==e.code)throw e}}};dt.styles=$e,e([ve({attribute:!1})],dt.prototype,"hass",void 0),e([_e()],dt.prototype,"_config",void 0),e([_e()],dt.prototype,"_templateResults",void 0),e([_e()],dt.prototype,"_unsubRenderTemplate",void 0),e([_e()],dt.prototype,"_unsubRenderTemplates",void 0),e([_e()],dt.prototype,"_width",void 0),e([he("#battery-grid-flow")],dt.prototype,"batteryGridFlow",void 0),e([he("#battery-home-flow")],dt.prototype,"batteryToHomeFlow",void 0),e([he("#grid-home-flow")],dt.prototype,"gridToHomeFlow",void 0),e([he("#solar-battery-flow")],dt.prototype,"solarToBatteryFlow",void 0),e([he("#solar-grid-flow")],dt.prototype,"solarToGridFlow",void 0),e([he("#solar-home-flow")],dt.prototype,"solarToHomeFlow",void 0),dt=e([ce("power-flow-card-plus")],dt);class ct extends TypeError{constructor(e,t){let o;const{message:i,explanation:a,...r}=e,{path:n}=e,l=0===n.length?i:`At path: ${n.join(".")} -- ${i}`;super(a??l),null!=a&&(this.cause=l),Object.assign(this,r),this.name=this.constructor.name,this.failures=()=>o??(o=[e,...t()])}}function ut(e){return"object"==typeof e&&null!=e}function vt(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function _t(e,t,o,i){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:a,branch:r}=t,{type:n}=o,{refinement:l,message:s=`Expected a value of type \`${n}\`${l?` with refinement \`${l}\``:""}, but received: \`${vt(i)}\``}=e;return{value:i,type:n,refinement:l,key:a[a.length-1],path:a,branch:r,...e,message:s}}function*ht(e,t,o,i){(function(e){return ut(e)&&"function"==typeof e[Symbol.iterator]})(e)||(e=[e]);for(const a of e){const e=_t(a,t,o,i);e&&(yield e)}}function*pt(e,t,o={}){const{path:i=[],branch:a=[e],coerce:r=!1,mask:n=!1}=o,l={path:i,branch:a};if(r&&(e=t.coercer(e,l),n&&"type"!==t.type&&ut(t.schema)&&ut(e)&&!Array.isArray(e)))for(const o in e)void 0===t.schema[o]&&delete e[o];let s="valid";for(const i of t.validator(e,l))i.explanation=o.message,s="not_valid",yield[i,void 0];for(let[d,c,u]of t.entries(e,l)){const t=pt(c,u,{path:void 0===d?i:[...i,d],branch:void 0===d?a:[...a,c],coerce:r,mask:n,message:o.message});for(const o of t)o[0]?(s=null!=o[0].refinement?"not_refined":"not_valid",yield[o[0],void 0]):r&&(c=o[1],void 0===d?e=c:e instanceof Map?e.set(d,c):e instanceof Set?e.add(c):ut(e)&&(void 0!==c||d in e)&&(e[d]=c))}if("not_valid"!==s)for(const i of t.refiner(e,l))i.explanation=o.message,s="not_refined",yield[i,void 0];"valid"===s&&(yield[void 0,e])}class yt{constructor(e){const{type:t,schema:o,validator:i,refiner:a,coercer:r=(e=>e),entries:n=function*(){}}=e;this.type=t,this.schema=o,this.entries=n,this.coercer=r,this.validator=i?(e,t)=>ht(i(e,t),t,this,e):()=>[],this.refiner=a?(e,t)=>ht(a(e,t),t,this,e):()=>[]}assert(e,t){return mt(e,this,t)}create(e,t){return function(e,t,o){const i=ft(e,t,{coerce:!0,message:o});if(i[0])throw i[0];return i[1]}(e,this,t)}is(e){return function(e,t){return!ft(e,t)[0]}(e,this)}mask(e,t){return function(e,t,o){const i=ft(e,t,{coerce:!0,mask:!0,message:o});if(i[0])throw i[0];return i[1]}(e,this,t)}validate(e,t={}){return ft(e,this,t)}}function mt(e,t,o){const i=ft(e,t,{message:o});if(i[0])throw i[0]}function ft(e,t,o={}){const i=pt(e,t,o),a=function(e){const{done:t,value:o}=e.next();return t?void 0:o}(i);if(a[0]){return[new ct(a[0],(function*(){for(const e of i)e[0]&&(yield e[0])})),void 0]}return[void 0,a[1]]}function gt(e,t){return new yt({type:e,schema:null,validator:t})}function bt(){return gt("any",(()=>!0))}function wt(){return gt("boolean",(e=>"boolean"==typeof e))}function xt(){return gt("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||`Expected an integer, but received: ${vt(e)}`))}function $t(){return gt("number",(e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${vt(e)}`))}function kt(e){const t=e?Object.keys(e):[],o=gt("never",(()=>!1));return new yt({type:"object",schema:e||null,*entries(i){if(e&&ut(i)){const a=new Set(Object.keys(i));for(const o of t)a.delete(o),yield[o,i[o],e[o]];for(const e of a)yield[e,i[e],o]}},validator:e=>ut(e)||`Expected an object, but received: ${vt(e)}`,coercer:e=>ut(e)?{...e}:e})}function Et(e){return new yt({...e,validator:(t,o)=>void 0===t||e.validator(t,o),refiner:(t,o)=>void 0===t||e.refiner(t,o)})}function Ct(){return gt("string",(e=>"string"==typeof e||`Expected a string, but received: ${vt(e)}`))}var zt=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function St(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!((i=e[o])===(a=t[o])||zt(i)&&zt(a)))return!1;var i,a;return!0}function Mt(e,t){void 0===t&&(t=St);var o=null;function i(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];if(o&&o.lastThis===this&&t(i,o.lastArgs))return o.lastResult;var r=e.apply(this,i);return o={lastResult:r,lastArgs:i,lastThis:this},r}return i.clear=function(){o=null},i}function At(){return{type:"expandable",title:lt("editor.combined"),schema:[{name:"entity",selector:{entity:{}}}]}}function Pt(){return{type:"expandable",title:lt("editor.separated"),name:"entity",schema:[{name:"consumption",label:"Consumption Entity",selector:{entity:{}}},{name:"production",label:"Production Entity",selector:{entity:{}}}]}}const Dt={name:"color",title:lt("editor.custom_colors"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"consumption",label:"Consumption",selector:{color_rgb:{}}},{name:"production",label:"Production",selector:{color_rgb:{}}}]}]},Tt=[{name:"entity",selector:{entity:{}}},{name:"template",label:"Template (overrides entity, save to update)",selector:{template:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"icon",selector:{icon:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}}]}],Ot=[{name:"color_icon",label:"Color of Icon",selector:{select:{options:[{value:!1,label:"Do not Color"},{value:!0,label:"Color dynamically"},{value:"production",label:"Production"},{value:"consumption",label:"Consumption"}],custom_value:!0}}},{name:"color_circle",label:"Color of Circle",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{min:0,max:1e6,step:1,mode:"box"}}},{name:"display_state",label:"Display State",selector:{select:{options:[{value:"two_way",label:"Two Way"},{value:"one_way",label:"One Way"},{value:"one_way_no_zero",label:"One Way (Show Zero)"}],custom_value:!0}}}];function jt(e){const t={type:"grid",column_min_width:"200px",schema:[{name:"name",selector:{text:{}}},{name:"icon",selector:{icon:{}}}]};return"battery"!==e&&"grid"!==e||t.schema.push(...Ot),t}const Nt=Object.assign(Object.assign({},jt("grid")),{schema:[...jt("grid").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),Gt=[At(),Pt(),Nt,Dt,{title:lt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Tt},{title:lt("editor.power_outage"),name:"power_outage",type:"expandable",schema:[{name:"entity",selector:{entity:{}}},{type:"grid",column_min_width:"200px",schema:[{name:"label_alert",label:"Outage Label",selector:{text:{}}},{name:"icon_alert",label:"Outage Icon",selector:{icon:{}}},{name:"state_alert",label:"Outage State",selector:{text:{}}}]}]}],Bt=Object.assign(Object.assign({},jt("battery")),{schema:[...jt("battery").schema,{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),Ft=[At(),Pt(),{title:lt("editor.state_of_charge"),name:"",type:"expandable",schema:[{name:"state_of_charge",label:"State of Charge Entity",selector:{entity:{}}},{name:"",type:"grid",column_min_width:"200px",schema:[{name:"state_of_charge_unit",label:"Unit",selector:{text:{}}},{name:"state_of_charge_unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"state_of_charge_decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"color_state_of_charge_value",label:"Color of Value",selector:{select:{options:[{value:!1,label:"Do Not Color"},{value:!0,label:"Color dynamically"},{value:"consumption",label:"Consumption"},{value:"production",label:"Production"}],custom_value:!0}}}]}]},Bt,Dt],Rt=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero_state",label:"Display State When Zero?",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"invert_state",label:"Invert State",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:lt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Tt}],Ht=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_of_measurement",label:"Unit of Measurement",selector:{text:{}}},{name:"calculate_flow_rate",label:"Calculate Flow Rate",selector:{boolean:{}}},{name:"decimals",label:"Decimals",selector:{number:{mode:"box",min:0,max:4,step:1}}},{name:"inverted_animation",label:"Invert Animation",selector:{boolean:{}}},{name:"show_direction",label:"Show Direction",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:lt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Tt}],Lt=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"state_type",label:"State Type",selector:{select:{options:[{value:"power",label:"Power"},{value:"percentage",label:"Percentage"}],custom_value:!0}}},{name:"color_value",label:"Color Value",selector:{boolean:{}}},{name:"color_icon",label:"Color Icon",selector:{boolean:{}}},{name:"display_zero",label:"Display Zero",selector:{boolean:{}}},{name:"display_zero_tolerance",label:"Display Zero Tolerance",selector:{number:{mode:"box",min:0,max:1e6,step:.1}}},{name:"display_zero_state",label:"Display Zero State",selector:{boolean:{}}},{name:"unit_white_space",label:"Unit White Space",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{name:"color",label:"Color",selector:{color_rgb:{}}},{title:lt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Tt}],It=[{name:"entity",selector:{entity:{}}},Object.assign(Object.assign({},jt()),{schema:[...jt().schema,{name:"color_value",label:"Color Value",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"color_icon",label:"Color Icon",selector:{select:{options:[{value:!0,label:"Color dynamically"},{value:!1,label:"Do Not Color"},{value:"solar",label:"Solar"},{value:"grid",label:"Grid"},{value:"battery",label:"Battery"}],custom_value:!0}}},{name:"subtract_individual",label:"Subtract Individual",selector:{boolean:{}}},{name:"override_state",label:"Override State (With Home Entity)",selector:{boolean:{}}},{name:"use_metadata",label:"Use Metadata",selector:{boolean:{}}}]}),{title:lt("editor.secondary_info"),name:"secondary_info",type:"expandable",schema:Tt}],Ut={name:"grey_color",selector:{color_rgb:{}}},Wt={name:"transparency",selector:{number:{min:0,max:100,step:1,mode:"box"}}},Vt={name:"",type:"grid",column_min_width:"200px",schema:[Wt,Ut]},Zt=e=>{switch(e){case"grey_out":return Ut;case"transparency":return Wt;case"custom":return Vt;default:return[]}},Kt=Mt(((e,t)=>[{name:"display_zero_lines",type:"grid",column_min_width:"400px",schema:[{name:"mode",selector:{select:{mode:"dropdown",options:[{value:"show",label:e("editor.show")},{value:"hide",label:e("editor.hide")},{value:"transparency",label:e("editor.transparency")},{value:"grey_out",label:e("editor.grey_out")},{value:"custom",label:e("editor.custom")}]}}},Zt(t)]}])),Yt=function(...e){const t="type"===e[0].type,o=e.map((e=>e.schema)),i=Object.assign({},...o);return t?function(e){const t=Object.keys(e);return new yt({type:"type",schema:e,*entries(o){if(ut(o))for(const i of t)yield[i,o[i],e[i]]},validator:e=>ut(e)||`Expected an object, but received: ${vt(e)}`,coercer:e=>ut(e)?{...e}:e})}(i):kt(i)}(kt({type:Ct(),view_layout:bt()}),kt({title:Et(Ct()),theme:Et(Ct()),dashboard_link:Et(Ct()),dashboard_link_label:Et(Ct()),inverted_entities:Et(bt()),w_decimals:Et(xt()),kw_decimals:Et(xt()),min_flow_rate:Et($t()),max_flow_rate:Et($t()),min_expected_power:Et($t()),max_expected_power:Et($t()),watt_threshold:Et($t()),clickable_entities:Et(wt()),transparency_zero_lines:Et($t()),greyout_zero_lines:Et(wt()),display_zero_lines:Et(bt()),use_new_flow_rate_model:Et(wt()),full_size:Et(wt()),style_ha_card:Et(bt()),style_card_content:Et(bt()),entities:kt({battery:Et(bt()),grid:Et(bt()),solar:Et(bt()),home:Et(bt()),fossil_fuel_percentage:Et(bt()),individual1:Et(bt()),individual2:Et(bt())})})),qt=[{name:"title",label:"Title",selector:{text:{}}}],Jt=Mt((e=>[{name:"entities",type:"grid",column_min_width:"400px",schema:[{title:e("editor.grid"),name:"grid",type:"expandable",schema:Gt},{title:e("editor.solar"),name:"solar",type:"expandable",schema:Rt},{title:e("editor.battery"),name:"battery",type:"expandable",schema:Ft},{title:e("editor.fossil_fuel_percentage"),name:"fossil_fuel_percentage",type:"expandable",schema:Lt},{title:e("editor.home"),name:"home",type:"expandable",schema:It},{title:`${e("editor.individual")} 1`,name:"individual1",type:"expandable",schema:Ht},{title:`${e("editor.individual")} 2`,name:"individual2",type:"expandable",schema:Ht}]}])),Qt=Mt(((e,t)=>[{title:e("editor.advanced"),type:"expandable",schema:[{type:"grid",column_min_width:"200px",schema:[{name:"dashboard_link",label:"Dashboard Link",selector:{navigation:{}}},{name:"dashboard_link_label",label:"Dashboard Link Label",selector:{text:{}}},{name:"w_decimals",label:"Watt Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"kw_decimals",label:"kW Decimals",selector:{number:{mode:"box",min:0,max:5,step:1}}},{name:"max_flow_rate",label:"Max Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_flow_rate",label:"Min Flow Rate (Sec/Dot)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"max_expected_power",label:"Max Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"min_expected_power",label:"Min Expected Power (in Watts)",selector:{number:{mode:"box",min:0,max:1e6,step:.01}}},{name:"watt_threshold",label:"Watt to Kilowatt Threshold",selector:{number:{mode:"box",min:0,max:1e6,step:1}}},{name:"clickable_entities",label:"Clickable Entities",selector:{boolean:{}}},{name:"use_new_flow_rate_model",label:"New Flow Model?",selector:{boolean:{}}}]},{type:"expandable",title:e("editor.display_zero_lines"),schema:[...Kt(e,t)]}]}])),Xt=async()=>{var e,t;if(customElements.get("ha-form"))return;const o=await(null===(t=(e=window).loadCardHelpers)||void 0===t?void 0:t.call(e));if(!o)return;const i=await o.createCardElement({type:"entity"});i&&await i.getConfigElement()};let eo=class extends se{constructor(){super(...arguments),this.showOther=!1,this._computeLabelCallback=e=>this.hass.localize(`ui.panel.lovelace.editor.card.generic.${null==e?void 0:e.name}`)||lt(`editor.${null==e?void 0:e.name}`)}async setConfig(e){mt(e,Yt),this._config=e}connectedCallback(){super.connectedCallback(),Xt()}render(){var e,t,o,i,a,r,n;if(!this.hass||!this._config)return V;const l=Object.assign(Object.assign({},this._config),{display_zero_lines:{mode:null!==(t=null===(e=this._config.display_zero_lines)||void 0===e?void 0:e.mode)&&void 0!==t?t:ke.displayZeroLines.mode,transparency:null!==(i=null===(o=this._config.display_zero_lines)||void 0===o?void 0:o.transparency)&&void 0!==i?i:ke.displayZeroLines.transparency,grey_color:null!==(r=null===(a=this._config.display_zero_lines)||void 0===a?void 0:a.grey_color)&&void 0!==r?r:ke.displayZeroLines.grey_color}});return I`<div class="card-config"><ha-form .hass="${this.hass}" .data="${l}" .schema="${qt}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${l}" .schema="${Jt(lt)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}" class="entities-section"></ha-form><div style="height:24px"></div><ha-form .hass="${this.hass}" .data="${l}" .schema="${Qt(lt,null===(n=l.display_zero_lines)||void 0===n?void 0:n.mode)}" .computeLabel="${this._computeLabelCallback}" @value-changed="${this._valueChanged}"></ha-form></div>`}_valueChanged(e){const t=e.detail.value||"";this._config&&this.hass&&function(e,t,o,i){i=i||{},o=null==o?{}:o;var a=new Event("config-changed",{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});a.detail=o,e.dispatchEvent(a)}(this,0,{config:t})}static get styles(){return u`ha-form{width:100%}ha-icon-button{align-self:center}.entities-section *{background-color:red}.card-config{display:flex;flex-direction:column;justify-content:space-between;align-items:center;margin-bottom:10px}.config-header{display:flex;flex-direction:row;justify-content:space-between;align-items:center;width:100%}.config-header.sub-header{margin-top:24px}ha-icon{padding-bottom:2px;position:relative;top:-4px;right:1px}`}};e([ve({attribute:!1})],eo.prototype,"hass",void 0),e([_e()],eo.prototype,"_config",void 0),e([_e()],eo.prototype,"showOther",void 0),eo=e([ce("power-flow-card-plus-editor")],eo);var to=Object.freeze({__proto__:null,loadHaForm:Xt,get PowerFlowCardPlusEditor(){return eo}});export{dt as PowerFlowCardPlus};
