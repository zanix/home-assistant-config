location_icon_background_color:
  name: Location Icon Background Color
  version: '1.0'
  creator: zanix
  description: Colorizes the icon background for an entity with a location, such as a person or device tracker.
  supported:
    - button
    - pop-up
  code: |-
    ${(() => {
        const config = this.config.location_icon_color || [];
        const element = card.querySelector('.bubble-icon-container');

        if (!config || !this.config.entity) {
          return;
        }

        const entity = hass.states[this.config.entity];
        if (!entity) {
          return;
        }

        const color = 'var(--state-location-unknown)';
        let colorVariable;
        if (['home', 'not_home', 'unknown'].includes(entity.state)) {
          colorVariable = `var(--state-location-${entity.state.replace('_', '-')})`;
        } else if (!['unknown', 'unavailable'].includes(entity.state)) {
          colorVariable = 'var(--state-location-zone)';
        }

        if (element) {
          element.style.background = `${colorVariable}`;
        }
      })()}
      #root {
        /* Define State colors. Can be added to theme */
        --state-location-home: var(--green-color);
        --state-location-not-home: var(--red-color);
        --state-location-zone: var(--blue-color);
        --state-location-unknown: var(--grey-color);
        --bubble-icon-color: var(--white-color);
      }
      .bubble-icon-container {
        opacity: 1 !important;
      }
  editor: ''
