###########################################################
# Sensor: Doors
###########################################################

- platform: template
  sensors:
    door_front:
      friendly_name: Front Door
      entity_id:
        - sensor.door_front_alarm_level
        - sensor.door_front_burglar
      value_template: >-
        {%- if is_state("sensor.door_front_alarm_level", "255") -%}
          {%- if is_state("sensor.door_front_burglar", "3") -%}
            Tampered
          {%- else -%}
            Open
          {%- endif %}
        {%- else -%}
          Closed
        {%- endif %}
      icon_template: >
        {%- if is_state("sensor.door_front_alarm_level", "255") -%}
          {%- if is_state("sensor.door_front_burglar", "3") -%}
            mdi:alert
          {%- else -%}
            mdi:door-open
          {%- endif %}
        {%- else -%}
          mdi:door
        {%- endif %}

    door_garage_entry:
      friendly_name: Garage Entry Door
      entity_id:
        - sensor.door_garage_entry_alarm_level
        - sensor.door_garage_entry_burglar
      value_template: >-
        {%- if is_state("sensor.door_garage_entry_alarm_level", "255") -%}
          {%- if is_state("sensor.door_garage_entry_burglar", "3") -%}
            Tampered
          {%- else -%}
            Open
          {%- endif %}
        {%- else -%}
          Closed
        {%- endif %}
      icon_template: >
        {%- if is_state("sensor.door_garage_entry_alarm_level", "255") -%}
          {%- if is_state("sensor.door_garage_entry_burglar", "3") -%}
            mdi:alert
          {%- else -%}
            mdi:door-open
          {%- endif %}
        {%- else -%}
          mdi:door
        {%- endif %}

    door_garage_outside:
      friendly_name: Garage Outside Door
      entity_id:
        - sensor.door_garage_outside_alarm_level
        - sensor.door_garage_outside_burglar
      value_template: >-
        {%- if is_state("sensor.door_garage_outside_alarm_level", "255") -%}
          {%- if is_state("sensor.door_garage_outside_burglar", "3") -%}
            Tampered
          {%- else -%}
            Open
          {%- endif %}
        {%- else -%}
          Closed
        {%- endif %}
      icon_template: >
        {%- if is_state("sensor.door_garage_outside_alarm_level", "255") -%}
          {%- if is_state("sensor.door_garage_outside_burglar", "3") -%}
            mdi:alert
          {%- else -%}
            mdi:door-open
          {%- endif %}
        {%- else -%}
          mdi:door
        {%- endif %}

    door_back:
      friendly_name: Sliding Door
      entity_id:
        - sensor.door_back_alarm_level
        - sensor.door_back_burglar
      value_template: >-
        {%- if is_state("sensor.door_back_alarm_level", "255") -%}
          {%- if is_state("sensor.door_back_burglar", "3") -%}
            Tampered
          {%- else -%}
            Open
          {%- endif %}
        {%- else -%}
          Closed
        {%- endif %}
      icon_template: >
        {%- if is_state("sensor.door_back_alarm_level", "255") -%}
          {%- if is_state("sensor.door_back_burglar", "3") -%}
            mdi:alert
          {%- else -%}
            mdi:door-open
          {%- endif %}
        {%- else -%}
          mdi:door
        {%- endif %}

    garage_door_status:
      friendly_name: Status
      entity_id: cover.garage_door
      value_template: >-
        {% if states.cover.garage_door %}
          {% if states.cover.garage_door.attributes["door_state"] == "open" %}
            Open
          {% elif states.cover.garage_door.attributes["door_state"] == "closed" %}
            Closed
          {% elif states.cover.garage_door.attributes["door_state"] == "opening" %}
            Opening
          {% elif states.cover.garage_door.attributes["door_state"] == "closing" %}
            Closing
          {% else %}
            Unknown
          {% endif %}
        {% else %}
          Offline
        {% endif %}
      icon_template: >
        {% if states.cover.garage_door %}
          {% if states.cover.garage_door.attributes["door_state"] == "open" %}
            mdi:garage-open
          {% elif states.cover.garage_door.attributes["door_state"] == "closed" %}
            mdi:garage
          {% elif states.cover.garage_door.attributes["door_state"] == "opening" %}
            mdi:arrow-expand-up
          {% elif states.cover.garage_door.attributes["door_state"] == "closing" %}
            mdi:arrow-expand-down
          {% else %}
            mdi:help-circle
          {% endif %}
        {% else %}
          mdi:cancel
        {% endif %}

    garage_car_present:
      friendly_name: Car in Garage
      value_template: >-
        {% if states.cover.garage_door %}
          {% if states.cover.garage_door.attributes["distance_sensor"] == "offline" %}
            Offline
          {% elif states.cover.garage_door.state == "open" %}
            Door Open
          {% elif ((states.cover.garage_door.attributes["distance_sensor"] > 50) and (states.cover.garage_door.attributes["distance_sensor"] < 170)) %}
            Yes
          {% else %}
            No
          {% endif %}
        {% else %}
          Offline
        {% endif %}
      icon_template: >
        {% if states.cover.garage_door %}
          {% if states.cover.garage_door.attributes["distance_sensor"] == "offline" %}
            mdi:cancel
          {% elif states.cover.garage_door.state == "open" %}
            mdi:garage-open
          {% elif ((states.cover.garage_door.attributes["distance_sensor"] > 50) and (states.cover.garage_door.attributes["distance_sensor"] < 170)) %}
            mdi:car
          {% else %}
            mdi:close-circle-outline
          {% endif %}
        {% else %}
          mdi:cancel
        {% endif %}
