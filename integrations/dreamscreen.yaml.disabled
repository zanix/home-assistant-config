---
# This enables the dreamscreen custom component.
#
# https://github.com/J3n50m4t/Home-Assistant-DreamScreen-Service
#
dreamscreen:
  devices:
    - family_room:
        address: !secret dreamscreen_family_room

input_select:
  dreamscreen_family_room_scene:
    name: Family Room Ambient Scene
    icon: mdi:video-input-hdmi
    options:
      - Select Scene
      - Random
      - Fire
      - Twinkle
      - Ocean
      - Pride
      - Fireworks
      - Holiday
      - Pop
      - Forest
    initial: Select Scene

sensor:
  platform: template
  sensors:
    ds_family_room_mode:
      friendly_name: Family Room Mode
      availability_template: "{{ not is_state('dreamscreen.family_room', 'unavailable') }}"
      value_template: >-
        {% if is_state_attr('dreamscreen.family_room', 'device_mode', 1) %}
          Video
        {% elif is_state_attr('dreamscreen.family_room', 'device_mode', 2) %}
          Music
        {% elif is_state_attr('dreamscreen.family_room', 'device_mode', 3) %}
          Ambient
        {% else %}
          Off
        {% endif %}
      icon_template: >-
        {% if is_state_attr('dreamscreen.family_room', 'device_mode', 1) %}
          mdi:television
        {% elif is_state_attr('dreamscreen.family_room', 'device_mode', 2) %}
          mdi:music-note
        {% elif is_state_attr('dreamscreen.family_room', 'device_mode', 3) %}
          mdi:lightbulb-on
        {% else %}
          mdi:power-off
        {% endif %}

automation:
  - id: dreamscreen_family_room_harmony_power_off
    alias: '[DreamScreen Family Room] Harmony Power Off'
    description: 'Turns off the Dreamscreen'

    trigger:
      platform: state
      entity_id: remote.family_room
      to: 'off'

    action:
      service: dreamscreen.set_mode
      data:
        entity_id: dreamscreen.family_room
        mode: 0

  - id: dreamscreen_family_room_harmony_reactive_activity
    alias: '[DreamScreen Family Room] Harmony Reactive Activity'
    description: 'Turns on the Dreamscreen reactive backlighting'

    trigger:
      platform: state
      entity_id: remote.family_room
      to: 'on'

    action:
      - service: dreamscreen.set_mode
        data:
          entity_id: dreamscreen.family_room
          mode: 1

# - service: dreamscreen.set_mode
#   data:
#     entity_id: dreamscreen.family_room
#     mode: 3
# - service: dreamscreen.set_ambiance_color
#   data:
#     entity_id: dreamscreen.family_room
#     color: '#331900'
