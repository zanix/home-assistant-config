###########################################################
# Automation: Mail Delivery
###########################################################

- alias: "[Notify] Mail Delivery"
  trigger:
    platform: state
    entity_id: sensor.usps_mail
  condition:
    - condition: template
      value_template: '{{ trigger.to_state.state | int != trigger.from_state.state | int }}'
  action:
    - service: notify.phone_user2
      data_template:
        title: Mail Delivery
        message: "You've got mail! {{ trigger.to_state.state }} pieces are waiting."
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/mailbox.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
    - service: notify.phone_user1
      data_template:
        title: Mail Delivery
        message: "You've got mail! {{ trigger.to_state.state }} pieces are waiting."
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/mailbox.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
