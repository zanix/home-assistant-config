---
id: printer_out_of_paper
alias: '[Printer] Out of Paper'
description: 'Sends a notification when the printer runs out of paper'

trigger:
  platform: state
  entity_id: sensor.canon_mf743c
  attribute: state_reason
  to: media-empty-error

condition: "{{ trigger.to_state.state != 'unknown' and trigger.to_state.state != 'unavailable' }}"

variables:
  message: 'The {{ trigger.to_state.attributes.friendly_name }} is out of paper'

action:
  - parallel:
      - service: script.notify_web
        data:
          title: 'Printer Alert'
          message: '{{ message }}'
          id: 'printer-paper-low'

      - service: script.notify_mobile
        data:
          who: 'josh'
          title: 'Printer Alert'
          message: '{{ message }}'
          icon: '/local/icons/printer-alert.png'
          group: 'system'
          tag: 'printer-paper-low'
          url: 'lovelace/computers'
