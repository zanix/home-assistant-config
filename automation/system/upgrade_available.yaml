---
id: system_upgrade_available
alias: '[System] Upgrade Available'
description: 'Sends a notification when a new release of Home Assistant is released'

trigger:
  platform: state
  entity_id: binary_sensor.docker_hub_update_available
  to: 'on'

action:
  - parallel:
      - service: script.notify_web
        data:
          title: 'Upgrade Available'
          message: '**Home Assistant** _{{ states("sensor.current_version") }}_ -> [_{{ states("sensor.available_version") }}_](https://www.home-assistant.io/latest-release-notes/)'
          id: 'upgrade-available'

      - service: script.notify_mobile
        data:
          who: 'josh'
          title: 'Upgrade Available'
          message: '<b>Home Assistant</b> <em>{{ states("sensor.current_version") }}</em> -> <em>{{ states("sensor.available_version") }}</em>'
          icon: '/local/icons/update.png'
          url: 'https://www.home-assistant.io/latest-release-notes/'
          group: 'Upgrade'
          tag: 'upgrade-available'
