###########################################################
# Automation [System]: Notify Failed Login
###########################################################

- alias: "[Notify] Failed Login"
  trigger:
    - platform: template
      value_template: "{{ states('persistent_notification.httplogin') != 'unknown' }}"
  action:
    - service: notify.phone_user1
      data_template:
        title: Failed Login
        message: "A failed login attempt was detected"
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
    - service: persistent_notification.create
      data:
        title: Failed Login
        message: "A failed login attempt was detected"
        notification_id: failed_login
