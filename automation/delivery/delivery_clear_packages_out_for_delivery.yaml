---
id: delivery_clear_packages_out_for_delivery
alias: '[Delivery] Clear Packages Out for Delivery'
description: 'Clears package delivery notification when packages are delivered'

trigger:
  - platform: state
    entity_id: sensor.mail_packages_in_transit
    to: "0"

condition:
  - condition: template
    value_template: '{{ trigger.to_state.state != "unavailable" and trigger.from_state.state != "unavailable" }}'
  - condition: template
    value_template: '{{ (trigger.from_state.state|int(default=0)) > 0 }}'
  - condition: template
    value_template: '{{ (trigger.to_state.state|int(default=0)) != (trigger.from_state.state|int(default=0)) }}'

action:
  - service: script.notify_mobile
    data:
      who: 'parents'
      title: ''
      message: 'clear_notification'
      tag: 'delivery-packages-pending'
