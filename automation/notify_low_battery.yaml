###########################################################
# Automation: Notify Sensor Low Battery
###########################################################

- alias: "[Notify] Sensor Low Battery"
  trigger:
    - platform: numeric_state
      entity_id: zwave.door_front_10
      value_template: '{{ state.attributes.battery_level }}'
      below: 20
    - platform: numeric_state
      entity_id: zwave.door_garage_inside_11
      value_template: '{{ state.attributes.battery_level }}'
      below: 20
    - platform: numeric_state
      entity_id: zwave.door_sliding_12
      value_template: '{{ state.attributes.battery_level }}'
      below: 20
    - platform: numeric_state
      entity_id: zwave.door_garage_outside_13
      value_template: '{{ state.attributes.battery_level }}'
      below: 20
    - platform: numeric_state
      entity_id: zwave.motion_kitchen_14
      value_template: '{{ state.attributes.battery_level }}'
      below: 20
  action:
    - service: notify.phone_1
      data_template:
        title: Low Battery
        message: "{{ trigger.entity_id.split('.')[1].split('_sensor')[0].lower().replace('_', ' ').title() }} batteries are at {{ trigger.to_state.state }}"
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/battery-alert.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
    - service: persistent_notification.create
      data:
        title: Low Battery
        message: "{{ trigger.entity_id.split('.')[1].split('_sensor')[0].lower().replace('_', ' ').title() }} batteries are at {{ trigger.to_state.state }}"
        notification_id: low_battery
