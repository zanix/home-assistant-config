###########################################################
# Automation: Package Delivery
###########################################################

- alias: "[Notify] Package Delivery"
  trigger:
    platform: state
    entity_id: sensor.deliveries_today
  condition:
    condition: and
    conditions:
      - condition: template
        value_template: '{{ trigger.to_state.state | int > 0 }}'
      - condition: template
        value_template: '{{ trigger.to_state.state | int != trigger.from_state.state | int }}'
  action:
    - service: notify.phone_josh
      data_template:
        title: Package Delivery
        message: "{{ states('sensor.deliveries_today') }} {% if is_state('sensor.deliveries_today', '1') %}package is{% else %}packages are{% endif %} out for delivery."
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/package-variant.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
    - service: notify.phone_amy
      data_template:
        title: Package Delivery
        message: "{{ states('sensor.deliveries_today') }} {% if is_state('sensor.deliveries_today', '1') %}package is{% else %}packages are{% endif %} out for delivery."
        data:
          icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/package-variant.png"
          smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
