---
# Sends a notification when a water leak is detected.
#
alias: "[Water] Notify when Leak Detected"
trigger:
  platform: state
  entity_id:
    - binary_sensor.leak_basement_bathroom
    - binary_sensor.leak_bathroom
    # - binary_sensor.leak_dishwasher
    - binary_sensor.leak_master_bathroom
    - binary_sensor.leak_water_heater
    # - binary_sensor.leak_washer
  to: "on"
action:
  - service: persistent_notification.create
    data_template:
      title: "Water Leak Detected"
      notification_id: water-leak
      message: >-
        The {{ trigger.to_state.name }} has detected a water leak.
  - service: notify.join_all
    data_template:
      title: "Water Leak Detected"
      message: >-
        The {{ trigger.to_state.name }} has detected a water leak.
      data:
        icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/battery-alert.png"
        smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
