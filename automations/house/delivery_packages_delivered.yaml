---
# Notifies when packages have been delivered.
#
alias: "[Delivery] Packages Delivered"
trigger:
  platform: state
  entity_id: sensor.mail_packages_delivered
condition:
  condition: and
  conditions:
    - condition: template
      value_template: "{{ (trigger.to_state.state | int) > 0 }}"
    - condition: template
      value_template: "{{ (trigger.to_state.state | int) != (trigger.from_state.state | int) }}"
action:
  service: notify.join_users
  data_template:
    title: Package Delivery
    message: "{{ trigger.to_state.state }} {% if trigger.to_state.state == '1' %}package is{% else %}packages are{% endif %} delivered."
    data:
      icon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/package-variant.png"
      smallicon: "https://raw.githubusercontent.com/zanix/home-assistant-config/master/www/icons/home-assistant.png"
