---
# The template platform supports sensors which get their values from other
# entities.
#
# https://www.home-assistant.io/integrations/ecobee/
# https://www.home-assistant.io/integrations/climate/
# https://www.home-assistant.io/integrations/template/
#
sensor:
  - name: Ecobee Mode
    availability: "{{ not states('climate.home') in ['unknown', 'unavailable'] }}"
    state: |
      {% if is_state_attr('climate.home', 'hvac_action', 'idle') and not states('climate.ecobee') in ['unknown', 'unavailable'] %}
        {{ state_attr('climate.ecobee', 'hvac_action') | capitalize }}
      {% else %}
        {{ state_attr('climate.home', 'hvac_action') | capitalize }}
      {% endif %}
