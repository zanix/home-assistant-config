---
# The template integration allows creating entities which derive their values
# from other data. This is done by specifying templates for properties of an
# entity, like the name or the state.
#
# https://www.home-assistant.io/integrations/template/
#
select:
  - name: "Family Room Source"
    availability: '{{ has_value("media_player.family_room_shield") and has_value("media_player.family_room_androidtv") }}'
    state: |-
      {%- from "variables.jinja" import androidtv %}
      {%- set source = state_attr('media_player.family_room_androidtv', 'app_id') | default('off', true) -%}
      {%- set sources = androidtv() | from_json -%}
      {{ iif(source in sources, sources[source], source) }}
    options: |-
      {%- from "variables.jinja" import androidtv %}
      {{ (androidtv() | from_json).values() | list }}
    select_option:
      - service: media_player.select_source
        target:
          entity_id: media_player.family_room_shield
        data:
          source: |-
            {%- from "util.jinja" import dict_flip %}
            {%- from "variables.jinja" import androidtv %}
            {%- set sources = dict_flip(androidtv() | from_json) | from_json -%}
            {{ iif(option in sources, sources[option], option) }}
