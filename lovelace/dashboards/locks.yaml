---
#
title: Locks

decluttering_templates:
  lock_card:
    default:
      - number: '1'
    card:
      type: vertical-stack
      cards:
        - type: custom:mushroom-title-card
          title: Code [[number]]
        - type: entities
          show_header_toggle: false
          entities:
            - 'input_text.front_door_name_[[number]]'
            - 'input_text.front_door_pin_[[number]]'

        - type: custom:expander-card
          gap: 0em
          padding: 0em
          overlay-margin: 0.5em
          child-padding: 0em
          title-card-padding: 0em
          title: Advanced Options
          title-card:
            type: vertical-stack
            cards:
              - type: custom:mushroom-chips-card
                chips:
                  - type: template
                    entity: 'input_boolean.enabled_front_door_[[number]]'
                    icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                    content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                    icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                    tap_action:
                      action: toggle
                  - type: template
                    entity: 'input_boolean.notify_front_door_[[number]]'
                    icon: mdi:{{ iif(states(entity) == "on", "bell", "bell-off") }}
                    content: Notify
                    icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                    tap_action:
                      action: toggle
                  - type: template
                    entity: 'sensor.connected_front_door_[[number]]'
                    icon: '{{ state_attr(entity, "icon") }}'
                    content: '{{ states(entity) }}'
                    icon_color: >-
                      {% if is_state(entity, "Connected") %}
                        green
                      {% elif is_state(entity, "Adding") %}
                        yellow
                      {% elif is_state(entity, "Disconnected") %}
                        disabled
                      {% elif is_state(entity, "Deleting") %}
                        red
                      {% endif %}
                    tap_action:
                      action: more-info
                  - type: template
                    entity: 'binary_sensor.active_front_door_[[number]]'
                    icon: mdi:{{ iif(states(entity) == "on", "lock-check", "lock-remove") }}
                    content: '{{ iif(states(entity) == "on", "On", "Off") }}'
                    icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                    tap_action:
                      action: more-info
              - type: custom:mushroom-title-card
                subtitle: Advanced Options
          cards:
            - type: custom:mushroom-chips-card
              alignment: justify
              chips:
                - type: template
                  entity: 'input_boolean.accesslimit_front_door_[[number]]'
                  icon: mdi:key-variant
                  icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                  content: Unlock limit
                  tap_action:
                    action: toggle
                - type: template
                  entity: 'input_boolean.reset_codeslot_front_door_[[number]]'
                  icon: mdi:lock-reset
                  icon_color: '{{ iif(states(entity) == "on", "red", "disabled") }}'
                  content: '{{ iif(states(entity) == "on", "Resetting", "Reset") }}'
                  tap_action:
                    action: none
                  hold_action:
                    action: toggle
            - type: custom:mushroom-number-card
              entity: 'input_number.accesscount_front_door_[[number]]'
              icon: mdi:counter
              icon_color: grey
              layout: horizontal
              display_mode: buttons
              secondary_info: none
            - type: custom:mushroom-chips-card
              alignment: justify
              chips:
                - type: template
                  entity: 'input_boolean.daterange_front_door_[[number]]'
                  icon: mdi:calendar-range
                  icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                  content: Date range limit
                  tap_action:
                    action: toggle
            - type: entities
              show_header_toggle: false
              entities:
                - 'input_datetime.start_date_front_door_[[number]]'
                - 'input_datetime.end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Sunday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.sun_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.sun_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.sun_start_date_front_door_[[number]]'
                    - 'input_datetime.sun_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Monday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.mon_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.mon_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.mon_start_date_front_door_[[number]]'
                    - 'input_datetime.mon_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Tuesday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.tue_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.tue_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.tue_start_date_front_door_[[number]]'
                    - 'input_datetime.tue_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Wednesday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.wed_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.wed_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.wed_start_date_front_door_[[number]]'
                    - 'input_datetime.wed_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Thursday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.thu_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.thu_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.thu_start_date_front_door_[[number]]'
                    - 'input_datetime.thu_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Friday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.fri_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.fri_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.fri_start_date_front_door_[[number]]'
                    - 'input_datetime.fri_end_date_front_door_[[number]]'

            - type: custom:expander-card
              title-card-button-overlay: true
              gap: 0em
              padding: 0em
              overlay-margin: 0.5em
              child-padding: 0em
              title-card-padding: 0em
              title: Saturday
              cards:
                - type: custom:mushroom-chips-card
                  alignment: justify
                  chips:
                    - type: template
                      entity: 'input_boolean.sat_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                      content: '{{ iif(states(entity) == "on", "Enabled", "Disabled") }}'
                      tap_action:
                        action: toggle
                    - type: template
                      entity: 'input_boolean.sat_inc_front_door_[[number]]'
                      icon: mdi:{{ iif(states(entity) == "on", "check-circle", "close-circle") }}
                      icon_color: '{{ iif(states(entity) == "on", "green", "red") }}'
                      content: '{{ iif(states(entity) == "on", "Include", "Exclude") }}'
                      tap_action:
                        action: toggle
                - type: entities
                  show_header_toggle: false
                  entities:
                    - 'input_datetime.sat_start_date_front_door_[[number]]'
                    - 'input_datetime.sat_end_date_front_door_[[number]]'

views:
  - title: Codes and Configuration
    layout:
      max_cols: 3
    type: custom:horizontal-layout
    cards:
      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '1'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '2'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '3'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '4'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '5'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '6'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '7'

      - type: custom:decluttering-card
        template: lock_card
        variables:
          - number: '8'

      - type: vertical-stack
        cards:
          - type: custom:mushroom-title-card
            title: Configuration
          - type: entities
            show_header_toggle: false
            entities:
              - input_text.front_door_lockname

              - type: custom:mushroom-chips-card
                alignment: justify
                chips:
                  - type: template
                    entity: input_boolean.front_door_lock_notifications
                    icon: mdi:{{ iif(states(entity) == "on", "bell", "bell-off") }}
                    content: Lock Notify
                    icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                    tap_action:
                      action: toggle
                  - type: template
                    entity: input_boolean.front_door_dooraccess_notifications
                    icon: mdi:{{ iif(states(entity) == "on", "bell", "bell-off") }}
                    content: Door Notify
                    icon_color: '{{ iif(states(entity) == "on", "green", "disabled") }}'
                    tap_action:
                      action: toggle

          - type: custom:vertical-stack-in-card
            cards:
              - type: custom:mushroom-template-card
                entity: binary_sensor.front_door_is_open
                primary: Front Door
                multiline_secondary: true
                secondary: >-
                  {% from "util.jinja" import custom_timedelta %}
                  {% if is_state(entity, "on") -%}
                    Open
                  {% elif is_state("lock.lock_front", "unlocked") -%}
                    Closed and Unlocked
                  {% else -%}
                    Closed and Locked
                  {% endif -%} {{ custom_timedelta(entity) }}
                icon: >-
                  {% if is_state(entity, "on") %}
                    mdi:door-open
                  {% elif is_state("lock.lock_front", "unlocked") and is_state(entity, "off") %}
                    mdi:door-closed
                  {% elif is_state("lock.lock_front", "locked") and is_state(entity, "off")
                  %}
                    mdi:door-closed-lock
                  {% endif %}
                icon_color: >-
                  {% if is_state(entity, "on") %}
                    red
                  {% elif is_state("lock.lock_front", "unlocked") and is_state(entity, "off") %}
                    yellow
                  {% elif is_state("lock.lock_front", "locked") and is_state(entity, "off")
                  %}
                    green
                  {% endif %}
                tap_action:
                  action: more-info
                hold_action:
                  action: fire-dom-event
                  browser_mod:
                    data:
                      entity: sensor.front_door_battery_level
                    service: browser_mod.more_info
                card_mod:
                  style:
                    mushroom-shape-icon$: |
                      {% from "util.jinja" import battery_color %}
                      .shape {
                        /* Radial progress bar */
                        background:
                          radial-gradient(var(--card-background-color) 60%, transparent calc(60% + 1px)),
                          conic-gradient(var(--{{ battery_color("sensor.front_door_battery_level") }}-color) {{ states("sensor.front_door_battery_level") }}% 0%, var(--card-background-color) 0% 100%
                        );
                      }
                      .shape:after {
                        /* Add back icon shape */
                        content: "";
                        height: 100%;
                        width: 100%;
                        position: absolute;
                        border-radius: var(--icon-border-radius);
                        background: var(--shape-color);
                      }
              - type: custom:layout-card
                layout_type: custom:grid-layout
                layout:
                  grid-template-columns: 65px auto
                  grid-template-rows: auto
                  margin: 0 -2px -10px -2px
                  padding: 0
                cards:
                  - type: custom:mushroom-template-card
                    entity: sensor.lock_front_battery_level
                    icon: mdi:lock-smart
                    icon_color: disabled
                    tap_action:
                      action: more_info
                    card_mod:
                      style:
                        .: |
                          ha-card {
                            --icon-size: 42px;
                            --ha-card-box-shadow: none;
                            --ha-card-border-width: 0;
                          }
                        mushroom-shape-icon$: |
                          {% from "util.jinja" import battery_color %}
                          .shape {
                            /* Radial progress bar */
                            background:
                              radial-gradient(var(--card-background-color) 60%, transparent calc(60% + 1px)),
                              conic-gradient(var(--{{ battery_color(config.entity) }}-color) {{ states(config.entity) }}% 0%, var(--card-background-color) 0% 100%
                            );
                          }
                          .shape:after {
                            /* Add back icon shape */
                            content: "";
                            height: 100%;
                            width: 100%;
                            position: absolute;
                            border-radius: var(--icon-border-radius);
                            background: var(--shape-color);
                          }
                  - type: custom:mushroom-lock-card
                    entity: lock.lock_front
                    name: Front Door
                    primary_info: none
                    secondary_info: none
                    icon_type: none
                    card_mod:
                      style:
                        .: |
                          ha-card {
                            --ha-card-box-shadow: none;
                            --ha-card-border-width: 0;
                            background: none;
                          }
